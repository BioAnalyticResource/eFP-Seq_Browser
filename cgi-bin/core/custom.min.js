var locus,version="v1.3.15-p20220117",colouring_mode="abs";null!=document.getElementById("locus")&&(locus=document.getElementById("locus").value);var new_locus,yscale_input,max_abs_scale,old_locus=locus;null!=document.getElementById("yscale_input")&&(yscale_input=document.getElementById("yscale_input").value),null!=document.getElementById("rpkm_scale_input")&&(max_abs_scale=document.getElementById("rpkm_scale_input").value);var rnaseq_success_current_time,rnaseq_success_end_time,locus_start=10326918,locus_end=10330048,splice_variants="",rnaseq_calls=[],exp_info=[],rnaseq_success=0,date_obj=new Date,rnaseq_success_start_time=date_obj.getTime(),max_absolute_fpkm=-1,max_log_fpkm=-1,svg_colouring_element=null,gene_structure_colouring_element=null,base_src="cgi-bin/data/bamdata_araport11.xml",upload_src="",dataset_dictionary={"Araport 11 RNA-seq data":"cgi-bin/data/bamdata_araport11.xml","Developmental transcriptome - Klepikova et al":"cgi-bin/data/bamdata_Developmental_transcriptome.xml"},loadNewDataset=!1,count_bam_entries_in_xml=113;function count_bam_num(){const e=new XMLHttpRequest;let t=base_src;e.responseType="document",e.onreadystatechange=()=>{if(e.readyState===XMLHttpRequest.DONE&&200===e.status){var t=e.responseXML;t&&t.getElementsByTagName("file")?count_bam_entries_in_xml=e.responseXML.getElementsByTagName("file").length:null==t&&console.log("failed at response"),document.getElementById("testing_count").innerHTML=count_bam_entries_in_xml}},e.open("GET",t),e.send()}function loadingScreen(e=!0){if(!1===e){document.getElementById("loading_screen").className="loading",document.getElementById("body_of").className="body_of_loading",document.getElementById("bodyContainer").classList.add("progressLoading"),document.getElementById("loading_screen").removeAttribute("hidden");let e=document.getElementsByClassName("disableOnLoading");for(var t=0;t<e.length;t++)$("#"+e[t].id).prop("disabled",!0)}else{document.getElementById("loading_screen").className="loading done_loading",document.getElementById("body_of").className="body_of_loading body_of_loading_done",document.getElementById("bodyContainer").classList.remove("progressLoading"),document.getElementById("loading_screen").setAttribute("hidden",!0);let e=document.getElementsByClassName("disableOnLoading");for(t=0;t<e.length;t++)$("#"+e[t].id).prop("disabled",!1);addGFF(),uploadingData=!1}}count_bam_num();var colouring_part,img_loading_base64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAAAyCAYAAADP/dvoAAAABmJLR0QAwADAAMAanQdUAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAB3RJTUUH4AoRDzYeAMpyUgAABGJJREFUeNrt3TFoE3scwPGvjxtOzKAQMEOECBkyROhQsWOEChURBFtssdJFB9Gl4OJkwaEtRRAUdLAUqYJgwamIEFAwUoS43RCw0AwpOjhkuCHDQd5Qes9q+7A+7cP2+1na5K53cH/Kl19yIfu63W4XSZL2qL+8BJIkQyhJ0h4VfPvExMSEV0WStGt92zknQkmSE+GPFFOSpN00CToRSpJkCCVJhlCSJEMoSZIhlCTJEEqSZAglSTKEkiQZQkmSDKEkSYZQkiRDKEmSIZQkyRBKe8HDhw/5/Pnzbzn2/v3709/Hx8d/23kkGULpp01PT9NoNH7LsTudDgBJktBut0mSxAsu/Q8CL4G0fUmSEEURcRxTLpc5ePBguu3Lly9EUUQ2m6VcLm/4u0ajQRzH9PT0/PNPGARcu3aNXC6X7lMqlVheXv5u3/Xt69NjJpOht7fXBZEMobRz2u02Z8+eJY5jCoUCtVqN58+fU6lUePLkCXfu3KGnp4d6vU5vby9zc3PA2peCzs7OUiqVvjvm8ePHWVlZoVAocPr0aQYHB6nX6zSbTSqVSnqMkZGRdHp88+YNw8PDzM/PuyiSIZR2zv3798lms7x9+xZYex/x5s2bLC0tce7cOYaHhwmCgHa7zaFDh5ibm6PZbDI9Pc3Hjx/J5/MsLCxQrVa3PMfhw4d5/fo1rVaLI0eOMDk5CUC1WuXTp08EQcCxY8e4cOGCCyIZQmlnffjwgfPnz6ePBwYGuHr1KrD2UmW1WqVWq7G6upru02w2yeVy5PN5AAYHB//1HOvb1/fvdDpkMhniOGZ5eZlCoUCSJOnLqZIMobRjkiRJb3RZF4YhAFNTUywuLnLr1i2KxSKPHj36df+sQUChUODSpUt0Oh0uXrzo+4PSL+Bdo9I2nThxgsePH6d3eS4sLDAwMADA+/fvOXPmDP39/RtiWSqVaLVaRFEEwN27d7d93iiKCIKA27dv8+DBAy5fvpxuazQa1Ov1dHp89uxZuq1ardJqtVw4yYlQ2r4wDDl58mT6eGZmhuvXr/Pu3TuOHj1KJpMhDENevHgBwNjYGFeuXOHVq1eEYUg2mwUgl8sxMzPDqVOnyOfz9PX1pS97/sgkCFAul2m32zx9+pQkSajVaoyOjjI5Ocns7CxRFPHy5UuiKGJkZIT+/n6y2Szj4+OMjY1x48YNF1TaxL5ut9v9+omJiYkNPyVtLo5jkiTZ8NEJWPv4BJBG8GudTockSchkMts+39TUFKurq9y7dw+Aer3O0NAQKysrLob0A7bqmxOh9JO2itlmAfx6wvxZfX19DA0NEYYhBw4cYHFxkdHRURdC+o8MofSHqFQqLC0tUavVAJifn9/0M4mSDKG0axWLRYrFohdC+oW8a1SSZAglSTKEkiQZQkmSDKEkSYZQkiRDKEmSIZQkyRBKkmQIJUkyhJIkGUJJkgyhJEmGUJKkP9mWX8PkN9RLkpwIJUna5fZ1u92ul0GS5EQoSdIe9DfEVWhcl8IjHgAAAABJRU5ErkJggg==",img_gene_struct_1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAAAIBAMAAACYMuIQAAAAFVBMVEX///8AAADcFDz/jAAAAP+m 3KYAfQDytQt7AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAATklEQVQ4jWNgYGANxQnC0iAggQEE0mAA lYcFgBWw4RZIQOEmYJNF0Q4zAQ4Qkqm4XQ8CIMWMw96HgsPdh4zD3oeCwx2MgDgc/vlw2JelAO7V xD0GmsY3AAAAAElFTkSuQmCC ",img_gene_struct_error="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAAAICAIAAADlfmh0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAMBSURBVGhD7Vi7ceswEGQrVBUMxC40wwKYKVANDpwpVuIqVIx6ealxHxzuA9BPsmfMGQOzgQgs7hZH3RrW8O/20dHR0dHxMrqN7gbneZAxLg/3GAlh13R6r8QhmgYQDtc3/Py2TMOwni2hCtg13/UM7M1x/gh06b6JHwxVx2X9zzfb8W10G90NXF/JozhdnNEmCKsNGgUU6EQtTgTsetZG99DJv6Xh18/eEtDt9efRbXQ30O6mH8XpwszjdFDWBu0BF9K40XmlTqSDj/M6ljssBqeBKXDXRASagb0c536k+WE4XjjL7f3KZJ4sHH1HRgF5QFgfKggzoRxnXO5GdluD04mPcGQfwQR/5CNXimNE+rwxi4RKM1ZVYKoPGwfPJc2px4P6ktDwBfGn6HgV3UZ3g9QSeWQ35BH/W6cZaCrXP6m74kbxSmICoWaj9MGR5fIiBPFrMQJYoj50N53yiB1bOCyM5tER0llgMoaKwjY4GBMhqYuGls6sDQoowurB5cgtTqmeSZHgs7SrB0x4rYmZ/m7B0tfFyVkKxy+JHi+sNtPxHLqN7gbwvVctmh+LV4YZ5U0J0Ay52exGB53oK2+iYXvYGwHKKAOWKJHqTyXGuhUKwAHBK6GCsAYnn8jJVhqaOrkIiYlBKgfX5WpxbPVU3nqWjerx0mUdl+sxbQE/rTO1NgRwuM5ZgJOqhfmlEqfjKXQb3Q1cS8gjt19rRrcErkaafKDI+Ehtg52J/Q+7jBGA8cE9ER5zx1KQPANxJCPtdSgdWxLpNpZ7lmyJoYKwBgeVkF9r2TpdUyc4Ow5YrR2cg8uRaxwrUuetZdmsHjDX0zKlFOd5Os4TESJTa0PYFwoCNgoSlkqcjqfQbXQ3wO89j3ShKB2C7Ycd5WfsDUuZhaU5G7W51C5q0dxmzIHfQ9kp3G+UYgTUkDxMV/M8SBUTYeUMpYQ62YeKwuqcnNfJNhqaOrmMJMxF0MGN9zlOQ6Q6rMmyWT1iQhx8dxJk6+CMXGd8WZX3qIWFpY5XcPv4BMHOh4rKP1r3AAAAAElFTkSuQmCC",absolute_rpkm_scale="iVBORw0KGgoAAAANSUhEUgAAAGQAAAAPCAMAAAAlD5r/AAABQVBMVEX///8AAADcFDz/jAAAAP+m 3KYAfQD//wD//AD/+QD/9wD/9AD/8gD/7wD/7QD/6gD/6AD/5QD/4gD/4AD/3QD/2wD/2AD/1gD/ 0wD/0QD/zgD/zAD/yQD/xgD/xAD/wQD/vwD/vAD/ugD/twD/tQD/sgD/rwD/rQD/qgD/qAD/pQD/ owD/oAD/ngD/mwD/mQD/lgD/kwD/kQD/jgD/jAD/iQD/hwD/hAD/ggD/fwD/fAD/egD/dwD/dQD/ cgD/cAD/bQD/awD/aAD/ZgD/YwD/YAD/XgD/WwD/WQD/VgD/VAD/UQD/TwD/TAD/SQD/RwD/RAD/ QgD/PwD/PQD/OgD/OAD/NQD/MwD/MAD/LQD/KwD/KAD/JgD/IwD/IQD/HgD/HAD/GQD/FgD/FAD/ EQD/DwD/DAD/CgD/BwD/BQD/AgCkIVxRAAAAs0lEQVQ4jWNg5+Dk4ubh5eMXEBQSFhEVE5eQlJKW kZWTV1BUUlZRVVPX0NTS1tHV0zcwNDI2MTUzt7C0sraxtbN3cHRydnF1c/fw9PL28fXzDwgMCg4J DQuPiIyKjomNi09ITEpOSU1Lz8jMYhi1hERLGBmpbgljbBwjiiWMnFyMVLcECOhkCZBIZUzPYKSV JaDgYkxKZkxNY2SkmU8gljDCLaFdxDMmw4NrGOWTUUuItwQAG8496iMoCNwAAAAASUVORK5CYII= ",relative_rpkm_scale="iVBORw0KGgoAAAANSUhEUgAAAGQAAAAPCAMAAAAlD5r/AAABQVBMVEX///8AAADcFDz/jAAAAP+m 3KYAfQAAAP8FBfkKCvQPD+8UFOoZGeUeHuAjI9soKNYtLdEzM8w4OMY9PcFCQrxHR7dMTLJRUa1W VqhbW6NgYJ5mZplra5NwcI51dYl6eoR/f3+EhHqJiXWOjnCTk2uZmWaenmCjo1uoqFatrVGysky3 t0e8vELBwT3GxjjMzDPR0S3W1ijb2yPg4B7l5Rnq6hTv7w/09Ar5+QX//wD/+wD/9gD/8QD/7AD/ 5wD/4gD/3QD/2AD/0wD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mgD/lQD/kAD/iwD/ hgD/gQD/fAD/dwD/cgD/bQD/ZwD/YgD/XQD/WAD/UwD/TgD/SQD/RAD/PwD/OgD/NAD/LwD/KgD/ JQD/IAD/GwD/FgD/EQD/DAD/BwBUljDTAAAA1klEQVQ4jWNg5+Dk4ubh5eMXEBQSFhEVE5eQlJKW kZWTV1BUUlZRVVPX0NTS1tHV0zcwNDI2MTUzt7C0sraxtbN3cHRydnF1c/fw9PL28fXzDwgMCg4J DQuPiIyKjomNi09ITEpOSU1Lz8jMYhi1hDRLGDi5GICWMBBvCSMjIUsYY+MYUS0BApJ8wmhlzUjI EiDAYgkD0CcMwgxUtQRIpDKmZzCiBBcDgwgDlSwBBRdjUjJjahojI2qcMAhT2RJGNEuAYUasJURH PGMyPLiGTz4ZtYQESwCEoDnh8dGTkQAAAABJRU5ErkJggg==",exon_intron_scale="iVBORw0KGgoAAAANSUhEUgAAALQAAAAPBAMAAAC/7vi3AAAAGFBMVEX///9QUFAAAADcFDz/jAAA AP+m3KYAfQCnICW7AAAArklEQVQ4jd3UMQ+CQAwF4OaG66ourpcO/DCGm7v17/vKBUU8SozBGBvy xo9HD6DzB3OicK4WTa7RfIGWgiiH0In6tBK/iMpKhsvyWAfB7NGlJEHQFA+6U5ZVjf2OTtfBI6YF OgIpadkaklGjZtrepIsXL63+U2s8vzHpila+0zsLEQe9ty+kQ7OuFgJ+pseY3nr5cIxtIQt6OkY/ 3lxReHMhF4nm1z+Zv6KP+/PdANuwQcLhhEyQAAAAAElFTkSuQmCC";function generate_colour(e,t,a){e=e.replace(/^\s*#|\s*$/g,""),t=t.replace(/^\s*#|\s*$/g,""),3==e.length&&(e=e.replace(/(.)/g,"$1$1")),3==t.length&&(t=t.replace(/(.)/g,"$1$1"));var i=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2,2),16),l=parseInt(e.substr(4,2),16),o=parseInt(t.substr(0,2),16)-i,s=parseInt(t.substr(2,2),16)-n,r=parseInt(t.substr(4,2),16)-l;return o=(o*a+i).toString(16).split(".")[0],s=(s*a+n).toString(16).split(".")[0],r=(r*a+l).toString(16).split(".")[0],1==o.length&&(o="0"+o),1==s.length&&(s="0"+s),1==r.length&&(r="0"+r),"#"+o+s+r}function round(e,t){return parseFloat(e.toFixed(t))}function colour_part_by_id(e,t,a,i){colouring_part="all";for(var n=0;n<sraList.length;n++)e.replace("_svg","")==sraList[n]&&(colouring_part=sraDict[sraList[n]].svg_part);let l=a;if(l=Array.isArray(l)?l[variantPosition]:parseFloat(l),(!(max_abs_scale=document.getElementById("rpkm_scale_input").value)||max_abs_scale<=0)&&(max_abs_scale=1e3),document.getElementById(e))var o=document.getElementById(e).getElementsByTagName("path"),s=document.getElementById(e).getElementsByTagName("g");var r=null;if(o&&s&&(r=Array.prototype.slice.call(o).concat(Array.prototype.slice.call(s))),null!=r){if("abs"==i){var d=255-parseInt(l/max_abs_scale*255);if("all"==colouring_part)for(n=0;n<r.length;n++)r[n].style.fill="rgb(255, "+d+", 0)";else for(n=0;n<r.length;n++)if(r[n].id==colouring_part)if("g"==r[n].tagName){var c=r[n].getElementsByTagName("path");for(ii=0;ii<c.length;ii++)c[ii].style.fill="rgb(255, "+d+", 0)"}else r[n].style.fill="rgb(255, "+d+", 0)"}else if("rel"==i){var u="",m=0;if("Missing controls data"!=l&&Math.abs(l)>3?m=3:"Missing controls data"!=l&&(m=Math.abs(l)),m/=3,"Missing controls data"==l?u="#D9D9D9":l>0?u=generate_colour("FFFF00","FF0000",m):0==l?u="FFFF00":l<0&&(u=generate_colour("FFFF00","0000FF",m)),"all"==colouring_part)for(n=0;n<r.length;n++)r[n].style.fill=u;else for(n=0;n<r.length;n++)if(r[n].id==colouring_part)if("g"==r[n].tagName){c=r[n].getElementsByTagName("path");for(ii=0;ii<c.length;ii++)c[ii].style.fill=u}else r[n].style.fill=u}document.getElementById(e.replace("_svg","_rpkm")).innerHTML="Missing controls data"==l?l:round(l,2)}else console.log("Paths is null for id = "+e)}var rpkmAverage=1,rpkmMedian=1;function findRPKMValuesAcrossAll(){if(sraDict){for(var e=Object.keys(sraDict),t=[],a=0,i=0;i<e.length;i++)if(sraDict[e[i]].RPKM){var n=sraDict[e[i]].RPKM[variantPosition];parseFloat(n)&&(t.push(n),a+=n)}t.length>0&&(rpkmMedian=math.median(t)),rpkmAverage=a/e.length}else displayError("ERROR IN RETRIEVING ALL DATA POINTS WITHIN DATASET")}function switchRPKMMode(e){let t=!1;"rel_radio"===e&&(t=!0),t?(colouring_mode="rel",document.getElementById("abs_radio").classList.remove("active"),document.getElementById("rel_radio").classList.add("active"),$("#rpkm_scale_input").prop("disabled",!0)):(colouring_mode="abs",document.getElementById("rel_radio").classList.remove("active"),document.getElementById("abs_radio").classList.add("active"),$("#rpkm_scale_input").removeAttr("disabled")),rnaseq_calls&&rnaseq_calls.length>0&&whichAbsOrRel()}function colour_svgs_now(){for(var e=colouring_mode,t=0;t<count_bam_entries_in_xml;t++){if(exp_info[t]){for(var a=exp_info[t][0].slice(0,-4),i=0,n=0,l=0,o=0;o<count_bam_entries_in_xml;o++)-1!=exp_info[t][2].indexOf(exp_info[o][0].slice(0,-4))&&(n++,i+=exp_info[o][3][variantPosition]);0===i&&sraDict[a].RPKM&&(i=sraDict[a].RPKM[variantPosition]),n>0?l=i/n:(rpkmMedian&&1===rpkmMedian&&findRPKMValuesAcrossAll(),l=rpkmMedian);var s=0,r=[],d="";0==(d=sraDict[a].RPKM&&sraDict[a].RPKM[variantPosition]?sraDict[a].RPKM[variantPosition]:0)&&0==l?(s=0,exp_info[t].splice(4,1,0)):s=Math.log2(d/l),r.push(s),sraDict[a].relativeRPKM=s,exp_info[t].splice(4,1,r),exp_info[t].splice(6,1,l),d>=max_absolute_fpkm&&(max_absolute_fpkm=d),"Missing controls data"!=exp_info[t][4]&&Math.abs(exp_info[t][4])>=max_log_fpkm&&Math.abs(exp_info[t][4])<1e3&&(max_log_fpkm=Math.abs(exp_info[t][4])),"rel"===colouring_mode?exp_info[t][4]||0==exp_info[t][4]||(exp_info[t][4]=-999999):exp_info[t][3][variantPosition]||0==exp_info[t][3][variantPosition]||(exp_info[t][3][variantPosition]=-999999)}else logError("Issue retrieving exp_info for "+e+" within BAM entry point "+t);whichAbsOrRel()}document.getElementById("landing").setAttribute("hidden","true"),$("#theTable").trigger("update"),change_rpkm_colour_scale(colouring_mode)}function get_input_values(){locus=(locus=document.getElementById("locus").value).trim().toUpperCase(),("Auto"==(yscale_input=document.getElementById("yscale_input").value)||parseInt(yscale_input)<1)&&(yscale_input=parseInt(-1)),max_abs_scale=document.getElementById("rpkm_scale_input").value}function update_all_images(e){null!=document.getElementById("locus")&&((new_locus=document.getElementById("locus").value)===old_locus?($.xhrPool.abortAll(),variants_radio_options(e),send_null_count=0):new_locus!=old_locus&&(getGFF(new_locus),old_locus=new_locus,setTimeout((function(){$.xhrPool.abortAll(),variants_radio_options(e),send_null_count=0}),1650)))}function variants_radio_options(e){get_input_values(),$.ajax({url:"./cgi-bin/get_gene_structures.cgi?locus="+locus,dataType:"json",success:function(t){locus_start=t.locus_start,locus_end=t.locus_end,splice_variants=JSON.stringify(t.splice_variants),populate_table(e),populate_efp_modal(e);var a=document.getElementById("variants_div");if(null!==a&&null!==a.firstChild&&void 0!==a.firstChild)for(;a.firstChild;)a.removeChild(a.firstChild);$("#variant_select").ddslick("destroy");var i='<select id="variant_select">';if(t.variant_count&&parseInt(t.variant_count)>0)for(var n=0;n<parseInt(t.variant_count);n++)t.splice_variants&&t.splice_variants[n]&&t.splice_variants[n].gene_structure&&(i+='<option value="'+n+'"',i+=' data-imagesrc="data:image/png;base64,'+t.splice_variants[n].gene_structure+'" style="max-width:none;"></option>');else i+='<option value="'+n+'"',i+=' data-imagesrc="'+img_gene_struct_error+'" style="max-width:none;"></option>';if(t.splice_variants&&t.splice_variants[0]&&t.splice_variants[0].gene_structure){img_gene_struct_1="data:image/png;base64,"+t.splice_variants[0].gene_structure;var l=document.getElementsByClassName("gene_structure_img");for(n=0;n<l.length;n++)l[n].src="data:image/png;base64,"+t.splice_variants[0].gene_structure}else{img_gene_struct_1=img_gene_struct_error;for(l=document.getElementsByClassName("gene_structure_img"),n=0;n<l.length;n++)l[n].src="data:image/png;base64,"+t.splice_variants[0].gene_structure}$("input[type=radio][name=radio_group]").change((function(){gene_structure_radio_on_change()})),i+="</select></div>",$("#variants_div").append(i),document.getElementById("variant_select")&&$("#variant_select").ddslick({width:"100%",onSelected:function(e){setData=e,gene_structure_radio_on_change(e)}}),document.getElementById("landing").setAttribute("hidden","true"),$("#theTable").trigger("update")},error:function(){displayError("ERROR IN get_gene_structures !")}})}function displayError(e){$("#displayError").empty();var t='<p class="warning_core" style="text-align:center;">'+e+" <br /><br /> PLEASE REFRESH PAGE, RELOAD OR RE-INPUT DATA OR TRY AGAIN AT A LATER TIME </p>";console.error("Error in logic:",e),$("#displayError").append(t),$("#locus_button").prop("disabled",!0),$("#abs_scale_button").prop("disabled",!0),progress_percent=100,$("div#progress").width(progress_percent+"%"),loadingScreen(!0),document.title=`eFP-Seq Browser: !ERROR! - ${locus} - ${datasetName}`}function logError(e){console.error("Error in logic:",e)}var variant_selected,variantPosition=0;function gene_structure_radio_on_change(){if(document.getElementsByClassName("dd-selected-value")&&document.getElementsByClassName("dd-selected-value")[0]&&document.getElementsByClassName("dd-selected-value")[0].value){variant_selected=document.getElementsByClassName("dd-selected-value")[0].value,variantPosition=variant_selected;for(var e=document.getElementsByClassName("dd-selected-image")[0].src,t=document.getElementsByClassName("gene_structure_img"),a=0;a<t.length;a++)t[a].src=e;for(a=0;a<exp_info.length;a++){var i=exp_info[a][0].split("_")[0];document.getElementById(i+"_gene_structure_img").src=e;var n,l=sraDict[i].r[variant_selected].toFixed(2);document.getElementById(i+"_rpb").innerHTML=l,sraDict[exp_info[a][0].split("_svg")[0]]||(sraDict[exp_info[a][0].split("_svg")[0]]={}),sraDict[exp_info[a][0].split("_svg")[0]].rpb=l,sraDict[i].RPKM&&sraDict[i].RPKM[variant_selected]?n=sraDict[i].RPKM[variant_selected].toFixed(2):sraDict[i].RPKM?logError("Unable to retrieve RPKM values at: [variant_selected] for "+i):sraDict[i]?logError('Unable to retrieve RPKM values at: ["RPKM"] for '+i):logError(sraDict?"Unable to retrieve RPKM values at: SRA within sraDict":"Unable to retrieve RPKM values at: sraDict unreachable"),document.getElementById(i+"_rpkm").innerHTML=n,whichAbsOrRel(!0,a)}}document.getElementById("landing").setAttribute("hidden","true"),$("#theTable").trigger("update")}function whichAbsOrRel(e=!1,t=0){if(!0===e)absOrRel(t);else if(exp_info.length>0)for(var a=0;a<exp_info.length;a++)absOrRel(a);change_rpkm_colour_scale(colouring_mode)}function absOrRel(e=0){var t=exp_info[e],a=t[0].slice(0,-4);if("rel"==colouring_mode&&sraDict[a].relativeRPKM){document.getElementById("compareGeneVariants").disabled=!0,t&&!t[4]&&0!=t[4]&&(t[4]=-999999);var i=sraDict[a].relativeRPKM.toFixed(2);document.getElementById(t[0].split("_svg")[0]+"_rpkm").innerHTML=i,sraDict[t[0].split("_svg")[0]].rpkm=i,colour_part_by_id(a+"_svg",sraDict[a].svg_part,sraDict[a].relativeRPKM,colouring_mode)}else{allCheckedOptions.length>0&&(document.getElementById("compareGeneVariants").disabled=!1),t[3]||0==t[3]||(t[3]=-999999);var n="";if(variant_selected&&sraDict[a].RPKM&&sraDict[a].RPKM[variant_selected]){i=sraDict[a].RPKM[variant_selected].toFixed(2);document.getElementById(t[0].split("_svg")[0]+"_rpkm").innerHTML=i,n=i}else{i=0;document.getElementById(t[0].split("_svg")[0]+"_rpkm").innerHTML=i,n=i}colour_part_by_id(a+"_svg",sraDict[a].svg_part,n,colouring_mode)}}function parseIntArray(e){for(var t=0,a=e.length;t<a;t++)e[t]=parseInt(e[t],10);return e}var rnaseq_image_url="cgi-bin/rnaSeqMapCoverage.cgi",match_drive="",progress_percent=0,sraList_check=[],rnaseq_change=1,totalreadsMapped_dic={},dumpOutputs="",dumpMethod="simple",callDumpOutputs=!1,rpkmCount=1,listOfRecordsDisplayed=[];function rnaseq_images(t){changePublicData();if(dumpOutputs="",data={},rnaseq_success=1,rpkmCount=1,match_drive="",listOfRecordsDisplayed=[],get_input_values(),CreateFilteredeFPList(),rnaseq_calls.length===count_bam_entries_in_xml){sraList_check=[],rnaseq_change=1;for(var a=0;a<count_bam_entries_in_xml;a++){var i=rnaseq_calls[a][0]||"undefined";let o=rnaseq_calls[a][1]||"unknown";if("Google Drive"===sraDict[sraList[a]].bam_type)l=(l=(n=sraDict[sraList[a]].drive_link).split("?usp=sharing"))[0].split("drive.google.com/drive/folders/"),match_drive=l.length>1?l[1]:n;else if("Amazon AWS"===sraDict[sraList[a]].bam_type){var n,l;1===(l=(n=sraDict[sraList[a]].drive_link).split("amazonaws.com/")).length&&(l=n.split("araport.cyverse-cdn.tacc.cloud/")),match_drive=l.length>1?l[1]:n}data={status:t,numberofreads:sraDict[sraList[a]].numberofreads,hexcodecolour:sraDict[sraList[a]].hexColourCode,remoteDrive:match_drive,bamType:sraDict[sraList[a]].bam_type,filename:sraDict[sraList[a]].filenameIn,tissue:i,record:o,locus:locus,variant:1,start:locus_start,end:locus_end,yscale:yscale_input,cachedDatapoints:publicData,struct:splice_variants,dumpMethod:dumpMethod},$.ajax({method:"POST",url:rnaseq_image_url,data:data,dataType:"json",failure:function(e){$("#failure").show()},success:function(t){var a=99;if(count_bam_entries_in_xml>0&&(a=parseInt((count_bam_entries_in_xml-1)/count_bam_entries_in_xml*100)),rnaseq_success++,date_obj3=new Date,rnaseq_success_current_time=date_obj3.getTime(),progress_percent=rnaseq_change/count_bam_entries_in_xml*100,$("div#progress").width(progress_percent+"%"),progress_percent>a&&loadingScreen(!0),document.getElementById("progress_tooltip").innerHTML="Current progress is at "+progress_percent+"% done",document.getElementById("progress").title=progress_percent.toFixed(2)+"% ("+rnaseq_change+"/"+count_bam_entries_in_xml+")",document.title="eFP-Seq Browser:",progress_percent<100&&(document.title+=` Loading ${progress_percent.toFixed(1)}% -`),document.title+=` ${locus} - ${datasetName}`,t.status&&"success"===t.status&&t.record){let a=t.record||"unknown";if(listOfRecordsDisplayed.includes(a)?(a=findUnusedRecordDisplayName(a,listOfRecordsDisplayed),listOfRecordsDisplayed.push(a)):listOfRecordsDisplayed.push(a),listOfRecordsDisplayed=[],sraList_check.push(a),sraDict[a].bp_length=parseFloat(t.end)-parseFloat(t.start),sraDict[a].bp_start=parseFloat(t.start),sraDict[a].bp_end=parseFloat(t.end),sraDict[a].MappedReads=t.reads_mapped_to_locus,totalreadsMapped_dic[a]=t.totalReadsMapped,sraDict[a].locusValue=t.locus,sraDict[a].r=t.r,sraDict[a].dataVisualization=t.rnaseqbase64,locus!=t.locus)throw"ERROR: "+locus+"'s RNA-Seq API request returned with data for some other locus.";var i=[];if(t.ss_y&&t.sum_y&&t.sum_xy&&t.sum_x&&t.ss_x&&t.end&&t.start){parseInt(t.ss_y);for(var n=parseInt(t.sum_y),l=parseInt(t.ss_y),o=parseIntArray(t.sum_xy.replace(/\[/g,"").replace(/\]/g,"").replace(/"/g,"").split(",")),s=parseIntArray(t.sum_x.replace(/\[/g,"").replace(/\]/g,"").replace(/"/g,"").split(",")),r=(parseIntArray(t.sum_xx.replace(/\[/g,"").replace(/\]/g,"").replace(/"/g,"").split(",")),parseIntArray(t.ss_x.replace(/\[/g,"").replace(/\]/g,"").replace(/"/g,"").split(",")),parseIntArray(t.ss_x.replace(/\[/g,"").replace(/\]/g,"").replace(/"/g,"").split(","))),d=parseInt(t.end)-parseInt(t.start),c=[],u=0;u<o.length;u++)c.splice(u,0,o[u]-s[u]*n/d),i.splice(u,0,c[u]/Math.sqrt(r[u]*l))}else i=t.r;if(document.getElementById(a+"_rnaseq_img")&&t.rnaseqbase64?"None"!==t.rnaseqbase64&&t.rnaseqbase64.length>=3?(document.getElementById(a+"_rnaseq_img").src="data:image/png;base64,"+t.rnaseqbase64,rnaseq_change+=1):(document.getElementById(a+"_rnaseq_img").src="https://"+window.location.host+window.location.pathname+"cgi-bin/img/error.png",console.error("Unable to create RNA-Seq map coverage data for: Locus - "+locus+", SRA - "+a+", dataset - "+base_src)):(document.getElementById(a+"_rnaseq_img")&&(document.getElementById(a+"_rnaseq_img").src="https://"+window.location.host+window.location.pathname+"cgi-bin/img/error.png"),console.error("Unable to create RNA-Seq map coverage data for: Locus - "+locus+", SRA - "+a+", dataset - "+base_src)),document.getElementById(a+"_rpb").innerHTML=parseFloat(i[0]).toFixed(2),sraDict[a].rpb=parseFloat(i[0]).toFixed(2),document.getElementById(a+"_rpkm").innerHTML=t["absolute-fpkm"],updateRPKMAbsoluteMax(t["absolute-fpkm"]),sraDict[a].RPKM=t["absolute-fpkm"],rpkmCount++,document.getElementById(a+"_totalReadsNum").innerHTML="Total reads = "+t.totalReadsMapped,1==callDumpOutputs)if(dumpOutputs+='\t\telif (record == "'+t.record+'"):\n',"complex"==dumpMethod){for(dumpOutputs+='\t\t\tdumpJSON(200, "'+t.locus+'", '+t.variant+", "+t.chromosome+", "+t.start+", "+t.end+', "'+t.record+'", "'+t.tissue+'", "'+t.rnaseqbase64+'", '+t.reads_mapped_to_locus+", "+t["absolute-fpkm"]+", ["+t.r+"], "+t.totalReadsMapped+", ["+t.exp_arr+"], [",i=0;i<t.ReadsMappedNucleotidePosition.length;i+=2)dumpOutputs+="["+t.ReadsMappedNucleotidePosition[i]+"]",i!=t.ReadsMappedNucleotidePosition.length-2&&(dumpOutputs+=", ");for(dumpOutputs+="], {",e=0;e<t.expected_expr_in_variant.length;e++)dumpOutputs+='"'+GFF_List[e].replace(locus,"")+'": ',dumpOutputs+="["+t.expected_expr_in_variant[e]+"]",e!=t.expected_expr_in_variant.length-1&&(dumpOutputs+=", ");dumpOutputs+="})\n"}else dumpOutputs+='\t\t\tdumpJSON(200, "'+t.locus+'", '+t.variant+", "+t.chromosome+", "+t.start+", "+t.end+', "'+t.record+'", "'+t.tissue+'", "'+t.rnaseqbase64+'", '+t.reads_mapped_to_locus+", ["+t["absolute-fpkm"]+"], ["+t.r+"], "+t.totalReadsMapped+")\n";for(var m=0;m<count_bam_entries_in_xml;m++)exp_info&&exp_info[m]&&exp_info[m][0]&&exp_info[m][0]==a+"_svg"&&(exp_info[m].splice(3,1,t["absolute-fpkm"]),exp_info[m].splice(5,1,i));colour_part_by_id(a+"_svg","Shapes",t["absolute-fpkm"][variantPosition],colouring_mode)}else if(t.status&&"fail"===t.status){let e=t.record||"unknown";listOfRecordsDisplayed.includes(e)?(e=findUnusedRecordDisplayName(e,listOfRecordsDisplayed),listOfRecordsDisplayed.push(e)):listOfRecordsDisplayed.push(e),e&&document.getElementById(e+"_rnaseq_img")&&(document.getElementById(e+"_rnaseq_img").src="https://"+window.location.host+window.location.pathname+"cgi-bin/img/error.png"),rnaseq_change+=1,e&&document.getElementById(e+"_rpb")&&(document.getElementById(e+"_rpb").innerHTML=null,sraDict[e]||(sraDict[e]={}),sraDict[e].rpb=null),e&&document.getElementById(e+"_rpkm")&&(document.getElementById(e+"_rpkm").innerHTML=null,updateRPKMAbsoluteMax(null),sraDict[e].RPKM=null),rpkmCount++,e&&document.getElementById(e+"_totalReadsNum")&&t.totalReadsMapped&&(document.getElementById(e+"_totalReadsNum").innerHTML="Total reads = "+t.totalReadsMapped),e&&document.getElementById(e+"_row")&&document.getElementById(e+"_row").classList.add("mainEntriesError"),console.error("Unable to create RNA-Seq map coverage data for: Locus - "+locus+", SRA - "+e+", dataset - "+base_src)}else console.log("Error!",t,data);rpkmCount==count_bam_entries_in_xml&&(colour_svgs_now(),date_obj4=new Date,rnaseq_success_end_time=date_obj4.getTime(),document.getElementById("progress_tooltip").innerHTML=rnaseq_success+" / count_bam_entries_in_xml requests completed<br/>Load time ~= "+String(round(parseInt(rnaseq_success_end_time-rnaseq_success_start_time)/6e4))+" mins."),document.getElementById("landing").setAttribute("hidden","true"),$("#theTable").trigger("update"),responsiveRNAWidthResize(),toggleResponsiveTable()}})}}}function findUnusedRecordDisplayName(e="unknown",t=sraList,a=0){if(Array.isArray(t)){let i=e+"_"+a;if(t.includes(i))findUnusedRecordDisplayName(e,t,a+1);else if(!t.includes(i))return i}else findUnusedRecordDisplayName(e,t=[])}function updateRPKMAbsoluteMax(e){var t=parseInt(document.getElementById("rpkm_scale_input").value);1e3===t&&(t=1);var a=parseInt(e);a>t&&(document.getElementById("rpkm_scale_input").value=a)}function checkAgainstSVG(e,t,a=!1){var i=t;if("ath-10dayOldSeedling.svg"===e||"ath-10dayOldSeedling.min.svg"===e)!0===a?i="10 Day Old Seedling":"all"!=t&&"root"!=t&&"shoot"!=t&&(i="all");else if("ath-15dayOldSeedling.svg"===e||"ath-15dayOldSeedling.min.svg"===e)!0===a?i="15 Day Old Seedling":"all"!=t&&"root"!=t&&"shoot"!=t&&(i="all");else if("ath-etiolatedSeedling.svg"===e||"ath-etiolatedSeedling.min.svg"===e)!0===a?i="Etiolated Seedling":"etiolatedseedling"!=t&&(i="etiolatedseedling");else if("ath-Flower.svg"===e||"ath-Flower.min.svg"===e)!0===a?i="Flower":"flower"!=t&&"receptacle"!=t&&(i="flower");else if("ath-FlowerParts.svg"===e||"ath-FlowerParts.min.svg"===e)!0===a?i="Flower Parts":"all"!=t&&"petals"!=t&&"stamen"!=t&&"sepals"!=t&&"carpels"!=t&&(i="all");else if("ath-GerminatingSeed.svg"===e||"ath-GerminatingSeed.min.svg"===e)!0===a?i="Germinating Seed":"all"!=t&&(i="all");else if("ath-Internode.svg"===e||"ath-Internode.min.svg"===e)!0===a?i="Internode":"all"!=t&&(i="all");else if("ath-leaf.svg"===e||"ath-leaf.min.svg"===e)!0===a?i="Leaf":"leaf"!=t&&(i="leaf");else if("ath-LeafParts.svg"===e||"ath-LeafParts.min.svg"===e)!0===a?i="Leaf Parts":"all"!=t&&"lamina"!=t&&"petiole"!=t&&"veins"!=t&&(i="all");else if("ath-Pollen.svg"===e||"ath-Pollen.min.svg"===e)!0===a?i="Pollen":"all"!=t&&(i="all");else if("ath-RootTip.svg"===e||"ath-RootTip.min.svg"===e)!0===a?i="Root Tip":"all"!=t&&(i="all");else if("ath-rosettePlusRoot.svg"===e||"ath-rosettePlusRoot.min.svg"===e)!0===a?i="Rosette Plus Root":"all"!=t&&"shoot"!=t&&"root"!=t&&(i="all");else if("ath-Seed1-4.svg"===e||"ath-Seed1-4.min.svg"===e)!0===a?i="Seed 1-4":"all"!=t&&(i="all");else if("ath-Seed5-7.svg"===e||"ath-Seed5-7.min.svg"===e)!0===a?i="Seed 5-7":"all"!=t&&(i="all");else if("ath-Seed8+.svg"===e||"ath-Seed8+.min.svg"===e)!0===a?i="Seed 8+":"all"!=t&&(i="all");else if("ath-SenescentLeaf.svg"===e||"ath-SenescentLeaf.min.svg"===e)!0===a?i="Senescent Leaf":"all"!=t&&(i="all");else if("ath-ShootApexInflorescense.svg"===e||"ath-ShootApexInflorescense.min.svg"===e)!0===a?i="Shoot Apex Inflorescense":"all"!=t&&(i="all");else if("ath-ShootApexVegetative-Transition.svg"===e||"ath-ShootApexVegetative-Transition.min.svg"===e)!0===a?i="Shoot Apex Vegetative-Transition":"all"!=t&&(i="all");else if("ath-Silique1-5.svg"===e||"ath-Silique1-5.min.svg"===e)!0===a?i="Silique 1-5":"all"!=t&&(i="all");else if("ath-Silique6-10.svg"===e||"ath-Silique6-10.min.svg"===e)!0===a?i="Silique 6-10":"all"!=t&&(i="all");else if("ath-YoungLeaf1-4.svg"===e||"ath-YoungLeaf1-4.min.svg"===e)!0===a?i="Young Leaf 1-4":"all"!=t&&(i="all");else if("ath-EarlyBuddingFlower.svg"===e||"ath-EarlyBuddingFlower.min.svg"===e)!0===a?i="Early Budding Flower":"all"!=t&&"shoot"!=t&&"buds"!=t&&(i="all");else if("ath-FlowerBud.svg"===e||"ath-FlowerBud.min.svg"===e)!0===a?i="Flower Bud":"flowerBud"==t&&"ath-10dayOldSeedling.min.svg"!==e||(i="flowerBud");else if("ath-Stamen.svg"===e||"ath-Stamen.min.svg"===e)!0===a?i="Stamen":"all"!=t&&"anthers"!=t&&"filament"!=t&&(i="all");else if("ath-StigmaAndOvaries.svg"===e||"ath-StigmaAndOvaries.min.svg"===e)!0===a?i="Stigma And Ovaries":"all"!=t&&"Stigma_tissue"!=t&&"Ovary_tissue"!=t&&(i="all");else if("ath-WholeSilique.svg"===e||"ath-WholeSilique.min.svg"===e)!0===a?i="Whole Silique":"all"!=t&&"silique"!=t&&"seed"!=t&&(i="silique");else if("ath-youngSeedling.svg"===e||"ath-youngSeedling.min.svg"===e)!0===a?i="Young Seedling":"all"!=t&&"root"!=t&&"hypocotyl"!=t&&"cotyledon"!=t&&(i="all");else if("ath-FlowerDevelopment1.svg"===e||"ath-FlowerDevelopment1.min.svg"===e)!0===a?i="Late Flower Development (1)":"flowerDevelopmentPart1"!=t&&(i="flowerDevelopmentPart1");else if("ath-FlowerDevelopment2.svg"===e||"ath-FlowerDevelopment2.min.svg"===e)!0===a?i="Flower Development 2":"flowerDevelopmentPart2"!=t&&(i="flowerDevelopmentPart2");else if("ath-FlowerDevelopment3.svg"===e||"ath-FlowerDevelopment3.min.svg"===e)!0===a?i="Flower Development 3":"flowerDevelopmentPart3"!=t&&(i="flowerDevelopmentPart3");else if("ath-FlowerDevelopment4.svg"===e||"ath-FlowerDevelopment4.min.svg"===e)!0===a?i="Flower Development 4":"flowerDevelopmentPart4"!=t&&(i="flowerDevelopmentPart4");else if("ath-FlowerDevelopment5.svg"===e||"ath-FlowerDevelopment5.min.svg"===e)!0===a?i="Flower Development 5":"flowerDevelopmentPart5"!=t&&(i="flowerDevelopmentPart5");else if("ath-FlowerDevelopment6-8.svg"===e||"ath-FlowerDevelopment6-8.min.svg"===e)!0===a?i="Flower Development 6-8":"flowerDevelopmentPart6"!=t&&(i="flowerDevelopmentPart6");else if("ath-FlowerDevelopment9-11.svg"===e||"ath-FlowerDevelopment9-11.min.svg"===e)!0===a?i="Flower Development 9-11":"flowerDevelopmentPart9"!=t&&(i="flowerDevelopmentPart9");else if("ath-FlowerDevelopment12-14.svg"===e||"ath-FlowerDevelopment12-14.min.svg"===e)!0===a?i="Flower Development 12-14":"flowerDevelopmentPart12"!=t&&(i="flowerDevelopmentPart12");else if("ath-FlowerDevelopment15-18.svg"===e||"ath-FlowerDevelopment15-18.min.svg"===e)!0===a?i="Flower Development 15-18":"flowerDevelopmentPart15"!=t&&(i="flowerDevelopmentPart15");else if("ath-FlowerDevelopment19.svg"===e||"ath-FlowerDevelopment19.min.svg"===e)!0===a?i="Flower Development 19":"flowerDevelopmentPart19"!=t&&(i="flowerDevelopmentPart19");else if("ath-Other.svg"===e||"ath-Other.min.svg"===e)if(!0===a)i="Other";else if("all"!=t)return"all";return i}var efp_table_column,variantdiv_str,sraList=[],sraDict={},sraCountDic={},tissueSRADic={},datasetName="data",iteration_num=1,moreDetails='Show More Details <i class="material-icons detailsIcon">arrow_drop_down</i>',lessDetails='Show Less Details <i class="material-icons detailsIcon">arrow_drop_up</i>';function populate_table(e){$("#theTable").empty(),$("#compareTable").empty(),rnaseq_calls=[],exp_info=[],rnaseq_success=0,date_obj5=new Date,rnaseq_success_start_time=date_obj5.getTime(),max_absolute_fpkm=-1,max_log_fpkm=-1,svg_colouring_element=null,gene_structure_colouring_element=null,sraList=[],sraDict={},sraCountDic={},tissueSRADic={},rpkmAverage=1,rpkmMedian=1;var t='<img loading="lazy" src="data:image/png;base64,'+exon_intron_scale+'" alt="RNA-Seq mapped image" style="float: right; margin-right: 10px;">',a='<thead><tr><th class="sortable colTitle" id="colTitle" onclick="ChangeColArrow(this.id)" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 250px;"><div class="row" id="colTitleRow"><div class="col-10">Title</div><div class="col-1"><img loading="lazy" class="sortingArrow" id="colTitleArrow" src="./cgi-bin/SVGs/arrowDefault.min.svg" alt="Sorting arrow"></div></div></th><th class="colRNA" id="colRNA" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; max-width: 576px;">RNA-Seq Coverage'+t+'</th><th class="sortable colrpb" id="colrpb" onclick="ChangeColArrow(this.id)" title="Point biserial correlation coefficient. Closer to 1 suggests a \'best\' match" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 75px;"><div class="row" id="colrpbRow"><div class="col-7" >r<sub>pb</sub></div><div class="col-1"><img loading="lazy" class="sortingArrow" id="colrpbArrow" src="./cgi-bin/SVGs/arrowDefault.min.svg" alt="Default sort arrow"></div></div></th><th class="coleFP" id="eFP_th" class="sortable" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 100px;">eFP (RPKM)</th><th class="sortable colRPKM" id="colRPKM" onclick="ChangeColArrow(this.id)" title="Reads Per Kilobase of transcript per Million mapped reads. Higher number suggest more mapped reads/expression" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 75px;"><div class="row" id="colRPKMRow"><div class="col-8">RPKM</div><div class="col-1"><img loading="lazy" class="sortingArrow" id="colRPKMArrow" src="./cgi-bin/SVGs/arrowDefault.min.svg" alt="Default sort arrow"></div></div></th><th class="sortable colDetails" id="colDetails" onclick="ChangeColArrow(this.id)" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 275px;"><div class="row" id="colDetailsRow"><div class="col-10">Details</div><div class="col-1"><img loading="lazy" class="sortingArrow" id="colDetailsArrow" src="./cgi-bin/SVGs/arrowDefault.min.svg" alt="Default sort arrow"></div></div></th><th class="sortable colCompare" id="colCompare" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; max-width: 30px;" hidden><div class="row" id="colCompareRow"></div></th></tr></thead><tbody id="data_table_body"></tbody>';$("#theTable").append(a);var n='<thead><tr><th id="compare_colTitle" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 250px;"><div class="row" id="compare_colTitleRow"><div class="col-xs-10">Title</div></div></th><th id="compare_colRNA" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; max-width: 576px;">RNA-Seq Coverage'+t+'</th><th id="compare_colrpb" title="Point biserial correlation coefficient. Closer to 1 suggests a \'best\' match" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 75px;"><div class="row" id="compare_colrpbRow"><div class="col-xs-6">r<sub>pb</sub></div></div></th><th id="compare_eFP_th" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 100px;">eFP (RPKM)</th><th id="compare_colRPKM" title="Reads Per Kilobase of transcript per Million mapped reads. Higher number suggest more mapped reads/expression" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 75px;"><div class="row" id="compare_colRPKMRow"><div class="col-xs-7">RPKM</div></div></th><th id="compare_colDetails" style="border: 1px solid #D3D3D3; background-color: #F0F0F0; width: 275px;"><div class="row" id="compare_colDetailsRow"><div class="col-xs-10">Details</div></div></th></tr></thead><tbody id="compare_table_body"></tbody>';$("#compareTable").append(n),$.ajax({url:base_src,dataType:"xml",success:function(t){$(t).find("files").each((function(){0===(datasetName=(datasetName=$(this).attr("xmltitle")||"Uploaded dataset").trim()).length&&(datasetName="Uploaded dataset"),document.getElementById("uploaded_dataset").innerHTML=datasetName})),document.title="eFP-Seq Browser:",progress_percent<100&&(document.title+=` Loading ${progress_percent.toFixed(1)}% -`),document.title+=` ${locus} - ${datasetName}`,iteration_num=1,$(t).find("file").each((function(){let t=$(this).attr("record_number")||"unknown";if(sraList.includes(t)&&(t=findUnusedRecordDisplayName(t,sraList)),sraList.includes(t)){if(sraCountDic[t]){sraCountDic[t]+=1;var a=t+"("+sraCountDic[t]+")";sraList.push(a),sraDict[a]={}}}else sraCountDic[t]=1,sraList.push(t),sraDict[t]={};var i=$(this).attr("description");sraDict[t].title=i;var n=$(this).attr("info");sraDict[t].description=n;var l=$(this).attr("svgname");sraDict[t].svg=l;var o=$(this).attr("svg_subunit");o=checkAgainstSVG(l,o),sraDict[t].svg_part=o,tissueSRADic[checkAgainstSVG(l,o,!0)]?tissueSRADic[checkAgainstSVG(l,o,!0)].push(t):tissueSRADic[checkAgainstSVG(l,o,!0)]=[t];var s=$(this).attr("url");sraDict[t].url=s;var r=$(this).attr("publication_link");sraDict[t].publicationid=r;var d,c=$(this).attr("total_reads_mapped");null!=c&&""!=c||(c="0"),sraDict[t].numberofreads=c,d=null==$(this).attr("hex_colour")||""==$(this).attr("hex_colour")?"0x64cc65":$(this).attr("hex_colour"),sraDict[t].hexColourCode=d;var u=$(this).attr("filename");null!=u&&""!=u&&null!=u||(u="accepted_hits.bam"),sraDict[t].filenameIn=u;var m=$(this).attr("species");sraDict[t].species=m;var g=[];if(null==$(this).find("controls")[0].innerHTML)for(_=1;_<$(this).find("controls")[0].childNodes.length;_+2)g.push($(this).find("controls")[0].childNodes[_].firstChild.textContent);else null!=$(this).find("controls")[0].innerHTML&&(g=$(this).find("controls")[0].innerHTML.replace(/<bam_exp>/g,"").replace(/<\/bam_exp>/g,",").replace(/\n/g," ").replace(/ /g,"").split(","));sraDict[t].controls=g;var p="";if(g.length>0)for(var _=g.length;_--;)"MEDIAN"!=g[_]?p+='<a href="https://www.ncbi.nlm.nih.gov/Traces/sra/?run='+g[_]+'"target="_blank" rel="noopener">'+g[_]+"</a> ":p+=g[_];sraDict[t].links=p;var h="";if(g.length>0)for(var v=0;v<g.length;v++)h+=g[v].toString(),v<g.length-2&&(h+=", ");sraDict[t].controlsString=h.trim();var f=$(this).attr("name");sraDict[t].name=f;var D=$(this).attr("svgname");D&&("ath-"===D.trim().substr(0,4)&&(D=D.slice(4,D.length).trim()),".svg"===D.trim().substr(D.length-4,4)&&(D=D.slice(0,D.length-4).trim())),rnaseq_calls.push([D,t]),sraDict[t].tissue=D;var b=$(this).attr("bam_type");sraDict[t].bam_type=b;var A=$(this).attr("name");sraDict[t].drive_link=A;var y=$(this).attr("read_map_method");sraDict[t].read_map_method=y;var w="https://bioviz.org/bar.html?";w+="version=A_thaliana_Jun_2009&",w+="gene_id="+locus+"&",w+="feature_url_0="+A+"&",w+="genome=A_thaliana_Jun_2009&",w+="annotation_set=Araport11&",w+="query_url="+A+"&",w+="server_url=bar";var x='<tr class="mainEntries" id="'+t+'_row">';document.getElementById("xmlDatabase").value,x+='<td class="colTitle" style="width: 250px; font-size: 12px;" id="'+t+'_title">'+i+"</td>\n",x+=`\n\t\t\t\t\t<td class="colRNA" style="max-width: 576px;">\n\t\t\t\t\t\t<img \n\t\t\t\t\t\t\tloading="lazy" \n\t\t\t\t\t\t\tid="${t}_rnaseq_img" \n\t\t\t\t\t\t\talt="RNA-Seq mapped image for: ${t}" \n\t\t\t\t\t\t\tstyle="min-width:420px; max-width:576px; width:95%; height: auto;" \n\t\t\t\t\t\t\tclass="rnaseq_img responsiveRNAWidth" \n\t\t\t\t\t\t\tsrc="${img_loading_base64}" \n\t\t\t\t\t\t/>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<br/>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<img \n\t\t\t\t\t\t\tloading="lazy" \n\t\t\t\t\t\t\tid="${t}_gene_structure_img" \n\t\t\t\t\t\t\tstyle="max-width: 576px; width:100%; height: auto;" \n\t\t\t\t\t\t\tclass="gene_structure_img" \n\t\t\t\t\t\t\tsrc="${img_gene_struct_1}" \n\t\t\t\t\t\t\talt="Gene variant image for: ${t}"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</td>\n\n\t\t\t\t`,x+='<td id="'+t+'_rpb" class="rpb_value colrpb" style="font-size: 12px; width: 50px; ">'+"-9999</td>",x+='<td class="coleFP" tag="svg_name" style="width: 75px;"><div id="'+t+'_svg" name="'+l.substring(0,l.length-4).slice(4)+'_tissue" tag='+o+'_subtissue" width="75" height="75" style="width: 75px; height: 75px; max-width: 75px; max-height: 75px;">'+document.getElementById(l.substring(4).replace(".svg","_svg")).innerHTML+'</div><div class="mdl-tooltip" for="'+t+'_svg">'+l.substring(4).replace(".svg","")+"</div></td>\n",x+='<td class="colRPKM" id="'+t+'_rpkm" style="font-size: 12px; width: 50px; ">-9999</td>',x+='<td class="colDetails" id="'+t+'_details" style="font-size: 12px;"><div id="'+t+'_description" name="'+n.trim()+'">'+truncateDescription(n)+"</div>","Amazon AWS"===b&&(x+='<div id="igbLink_'+t+'">Show: <a href="'+w+'" target="_blank" rel="noopener">Alignments in IGB</a></div>'),t.includes("unknown")&&!r||(x+='<div id="extraLinks_'+t+'">Go to: ',t.includes("unknown")||(x+='<a href="'+s+'" target="_blank" rel="noopener">NCBI SRA</a>'),t.includes("unknown")&&r&&(x+=" or "),r&&(x+='<a href="'+r+'" target="_blank" rel="noopener">PubMed</a>'),x+="</div>"),x+='<a id="clickForMoreDetails_'+iteration_num+'" name="'+t+'_description" onclick="clickDetailsTextChange(this.id)" href="javascript:(function(){$(\'#'+t+"').toggle();})()\">"+moreDetails.trim()+"</a>",x+='<div id="'+t+'" class="moreDetails" style="display:none">',p&&(x+="Controls: "+p+"<br/>"),x+="Species: "+m+"<br>",x+='<div id="'+t+'_sra">SRA: '+t+"</div>",x+='<div id="'+t+'_totalReadsNum">Total reads = '+c+"</div>",null!=y&&y.length>0&&(x+='<div id="'+t+'_readMappedMethod">Read map method = '+y.trim()+"</div>"),x+='<a id="clickForMoreDetails_'+iteration_num+'_less" name="'+t+'_description" onclick="clickDetailsTextChange(this.id)" href="javascript:(function(){$(\'#'+t+"').toggle();})()\">"+lessDetails+"</a></div></td>\n",x+='<td class="colCompare" style="font-size: 12px; max-width: 30px;"><div id="'+t+'_compareVariant"><input type="checkbox" name="compareCheckbox" class="compareCheckbox" value="compareCheckbox" id="'+t+'_compareCheckbox" onclick="tableCheckbox(this.id);"></div></td>',x+="</tr>",iteration_num++,$("#theTable").append(x);var E=document.getElementsByClassName("fltrow")[0].childNodes[6];(E&&void 0===E.classList[0]||"undefined"===E.classList[0])&&(E.classList=["colCompare"],E.innerHTML='<input type="checkbox" name="compareCheckbox" class="compareCheckbox" value="compareCheckbox" id="allCheckbox" onclick="disableAllComparison();">'),exp_info.push([t+"_svg",o,g,0,0,0,0]),!0===loadNewDataset?(setTimeout((function(){count_bam_num()}),200),setTimeout((function(){rnaseq_images(e)}),10)):rnaseq_images(e)})),$.tablesorter.addParser({id:"rpb_sorter",is:function(e){return!1},format:function(e){return NaN==e?-99999:null==e?-999999:e==1/0?99999:e==-1/0?-99999:parseFloat(e)},type:"numeric"}),$.tablesorter.addParser({id:"rpkm_sorter",is:function(e){return!1},format:function(e){return NaN==e?-99999:null==e?-999999:e==1/0?99999:e==-1/0?-99999:"Missing controls data"==e?-9999999:parseFloat(e)},type:"numeric"}),$("#theTable").tablesorter({headers:{0:{},1:{sorter:!1},2:{sorter:"rpb_sorter"},3:{},4:{sorter:"rpkm_sorter"},5:{}}}),$("#theTable").trigger("update")}});for(new TableFilter("theTable",{base_path:"cgi-bin/core/packages/tableFilter/",columns_exact_match:[!1,!1,!1,!1,!1,!1],watermark:["Filter","Filter","Filter","Filter","Filter","Filter"],highlight_keywords:!1,no_results_message:!0,auto_filter:!0,auto_filter_delay:500,col_1:"none",popup_filters:!1,filters_row_index:1,alternate_rows:!1,msg_filter:"Filtering..."}).init(),change_rpkm_colour_scale(colouring_mode),i=0;i<colSortList.length;i++){CheckElementWidth(colSortList[i]+"Arrow",8)}createVariantDiv()}function createVariantDiv(){null==gene_structure_colouring_element&&document.getElementById("flt1_theTable")&&document.getElementById("flt1_theTable").parentElement&&(gene_structure_colouring_element=document.getElementById("flt1_theTable").parentElement),gene_structure_colouring_element.innerHTML="",$("#variant_select").ddslick("destroy"),document.getElementsByClassName("fltrow")[0].childNodes[1].innerHTML="",variantdiv_str='<div id="variants_div">',variantdiv_str+="</div>",document.getElementsByClassName("fltrow")[0].childNodes[1].innerHTML=variantdiv_str,$("#variant_select").ddslick({width:"100%",onSelected:function(e){setData=e,gene_structure_radio_on_change(e)}})}function clickDetailsTextChange(e){if(null!=document.getElementById(e))if(document.getElementById(e).innerHTML==moreDetails)document.getElementById(e).setAttribute("hidden",!0),(t=document.getElementById(document.getElementById(e).name)).textContent=t.getAttribute("name");else if(document.getElementById(e).innerHTML==lessDetails){var t,a=e.substring(0,e.length-5);document.getElementById(a).removeAttribute("hidden"),(t=document.getElementById(document.getElementById(e).name)).textContent=truncateDescription(t.getAttribute("name"))}}function truncateDescription(e){if(null!=e||null!=e)return e.length>30?e.substring(0,30)+"...":e}var remainder_efp=0,efp_length=0,eFPSortedSRA=[],efp_RPKM_values=[];function populate_efp_modal(e){toggleResponsiveTable(2),$("#efpModalTable").empty(),efp_table_column="",eFPSortedSRA=[];var t=document.getElementsByClassName("colTitle");for(s=2;s<t.length;s++){var a=t[s].id.substr(0,t[s].id.length-6);"none"!=document.getElementById(a+"_row").style.display&&eFPSortedSRA.push(a)}for(remainder_efp=eFPSortedSRA.length%11,efp_length=eFPSortedSRA.length,efp_RPKM_values=[],i=0;i<eFPSortedSRA.length;i++)0==isNaN(parseFloat(sraDict[eFPSortedSRA[i]].RPKM))&&efp_RPKM_values.push(parseFloat(sraDict[eFPSortedSRA[i]].RPKM));for($("#efpModalTable").append('<p class="eFP_thead"> AGI-ID: <a href="https://www.arabidopsis.org/servlets/TairObject?type=locus&name='+locus+'" target="_blank" rel="noopener">'+locus+"</a></p>"),"abs"===colouring_mode?$("#efpModalTable").append(`\n\t\t\t\t<p class="eFP_thead"> \n\t\t\t\t\teFP Colour Scale: \n\n\t\t\t\t\t<img \n\t\t\t\t\t\tloading="lazy" \n\t\t\t\t\t\tsrc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAPCAMAAAAlD5r/AAABQVBMVEX///8AAADcFDz/jAAAAP+m 3KYAfQD//wD//AD/+QD/9wD/9AD/8gD/7wD/7QD/6gD/6AD/5QD/4gD/4AD/3QD/2wD/2AD/1gD/ 0wD/0QD/zgD/zAD/yQD/xgD/xAD/wQD/vwD/vAD/ugD/twD/tQD/sgD/rwD/rQD/qgD/qAD/pQD/ owD/oAD/ngD/mwD/mQD/lgD/kwD/kQD/jgD/jAD/iQD/hwD/hAD/ggD/fwD/fAD/egD/dwD/dQD/ cgD/cAD/bQD/awD/aAD/ZgD/YwD/YAD/XgD/WwD/WQD/VgD/VAD/UQD/TwD/TAD/SQD/RwD/RAD/ QgD/PwD/PQD/OgD/OAD/NQD/MwD/MAD/LQD/KwD/KAD/JgD/IwD/IQD/HgD/HAD/GQD/FgD/FAD/ EQD/DwD/DAD/CgD/BwD/BQD/AgCkIVxRAAAAs0lEQVQ4jWNg5+Dk4ubh5eMXEBQSFhEVE5eQlJKW kZWTV1BUUlZRVVPX0NTS1tHV0zcwNDI2MTUzt7C0sraxtbN3cHRydnF1c/fw9PL28fXzDwgMCg4J DQuPiIyKjomNi09ITEpOSU1Lz8jMYhi1hERLGBmpbgljbBwjiiWMnFyMVLcECOhkCZBIZUzPYKSV JaDgYkxKZkxNY2SkmU8gljDCLaFdxDMmw4NrGOWTUUuItwQAG8496iMoCNwAAAAASUVORK5CYII=" \n\t\t\t\t\t\tclass="colourScale" \n\t\t\t\t\t\talt="Absolute RPKM colour scale"\n\t\t\t\t\t/> \n\t\t\t\t\t\n\t\t\t\t\tMin: ${Math.min.apply(null,efp_RPKM_values).toFixed(1)} RPKM, \n\t\t\t\t\t\t\n\t\t\t\t\tMax: ${Math.max.apply(null,efp_RPKM_values).toFixed(1)} RPKM\n\t\t\t\t</p>\n\t\t\t\t\n\t\t\t\t<br />\n\t\t\t\t\n\t\t\t\t<table>\n\t\t\t\t\t<tbody class="eFP_tbody">\n\t\t\t\t</tbody>\n\t\t\t`):"rel"===colouring_mode&&$("#efpModalTable").append(`\n\t\t\t\t<p class="eFP_thead"> \n\t\t\t\t\teFP Colour Scale: \n\n\t\t\t\t\t<img \n\t\t\t\t\t\tloading="lazy" \n\t\t\t\t\t\tsrc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAPCAMAAAAlD5r/AAABQVBMVEX///8AAADcFDz/jAAAAP+m 3KYAfQAAAP8FBfkKCvQPD+8UFOoZGeUeHuAjI9soKNYtLdEzM8w4OMY9PcFCQrxHR7dMTLJRUa1W VqhbW6NgYJ5mZplra5NwcI51dYl6eoR/f3+EhHqJiXWOjnCTk2uZmWaenmCjo1uoqFatrVGysky3 t0e8vELBwT3GxjjMzDPR0S3W1ijb2yPg4B7l5Rnq6hTv7w/09Ar5+QX//wD/+wD/9gD/8QD/7AD/ 5wD/4gD/3QD/2AD/0wD/zQD/yAD/wwD/vgD/uQD/tAD/rwD/qgD/pQD/oAD/mgD/lQD/kAD/iwD/ hgD/gQD/fAD/dwD/cgD/bQD/ZwD/YgD/XQD/WAD/UwD/TgD/SQD/RAD/PwD/OgD/NAD/LwD/KgD/ JQD/IAD/GwD/FgD/EQD/DAD/BwBUljDTAAAA1klEQVQ4jWNg5+Dk4ubh5eMXEBQSFhEVE5eQlJKW kZWTV1BUUlZRVVPX0NTS1tHV0zcwNDI2MTUzt7C0sraxtbN3cHRydnF1c/fw9PL28fXzDwgMCg4J DQuPiIyKjomNi09ITEpOSU1Lz8jMYhi1hDRLGDi5GICWMBBvCSMjIUsYY+MYUS0BApJ8wmhlzUjI EiDAYgkD0CcMwgxUtQRIpDKmZzCiBBcDgwgDlSwBBRdjUjJjahojI2qcMAhT2RJGNEuAYUasJURH PGMyPLiGTz4ZtYQESwCEoDnh8dGTkQAAAABJRU5ErkJggg==" \n\t\t\t\t\t\tclass="colourScale" \n\t\t\t\t\t\talt="Relative RPKM colour scale"\n\t\t\t\t\t/> \n\t\t\t\t\t\n\t\t\t\t\tMin: ${Math.min.apply(null,efp_RPKM_values).toFixed(1)}, \n\t\t\t\t\t\t\n\t\t\t\t\tMax: ${Math.max.apply(null,efp_RPKM_values).toFixed(1)}\n\t\t\t\t</p>\n\t\t\t\t\n\t\t\t\t<br />\n\t\t\t\t\n\t\t\t\t<table>\n\t\t\t\t\t<tbody>\n\t\t\t\t</tbody>\n\t\t\t`),$("#efpModalTable").append('<table id="eFPtable" class="table"></table>'),i=0;i<11*~~(eFPSortedSRA.length/11);i+=11)if("null"!=document.getElementById(eFPSortedSRA[i+10]).outerHTML){for(efp_table_column="<tr>",r=0;r<11;r++)efp_table_column+='<td><div class="efp_table_tooltip" id="'+eFPSortedSRA[i+r]+'_rep" onclick="ScrollToRNARow(\''+eFPSortedSRA[i+r]+"_row')\">"+document.getElementById(eFPSortedSRA[i+r]+"_svg").outerHTML+'<span class="efp_table_tooltip_text">'+eFPSortedSRA[i+r]+" - "+sraDict[eFPSortedSRA[i+r]].title+"</span></div></td>";efp_table_column+="</tr>",$("#eFPtable").append(efp_table_column)}for(r=0;r<12;r++)if(remainder_efp===r){for(efp_table_column="<tr>",c=remainder_efp;c>0;c--)efp_table_column+='<td><div class="efp_table_tooltip" id="'+eFPSortedSRA[efp_length-c]+'_rep" onclick="ScrollToRNARow(\''+eFPSortedSRA[efp_length-c]+"')\">"+document.getElementById(eFPSortedSRA[efp_length-c]+"_svg").outerHTML+'<span class="efp_table_tooltip_text">'+eFPSortedSRA[efp_length-c]+" - "+sraDict[eFPSortedSRA[efp_length-c]].title+"</span></div></td>";efp_table_column+="</tr>",$("#eFPtable").append(efp_table_column)}toggleResponsiveTable()}function change_rpkm_colour_scale(e){var t;(null===svg_colouring_element&&document.getElementById("flt3_theTable")&&document.getElementById("flt3_theTable").parentElement&&(svg_colouring_element=document.getElementById("flt3_theTable").parentElement),svg_colouring_element&&svg_colouring_element.innerHTML&&(svg_colouring_element.innerHTML=""),"rel"==e)?((t=document.createElement("img")).src="data:image/png;base64,"+relative_rpkm_scale,t.style="margin-top: 10px;",svg_colouring_element&&svg_colouring_element.appendChild(t)):((t=document.createElement("img")).src="data:image/png;base64,"+absolute_rpkm_scale,t.style="margin-top: 10px;",svg_colouring_element&&svg_colouring_element.appendChild(t));var a=["colTitle","colRNA","colrpb","coleFP","colRPKM","colDetails"],i=[];document.getElementsByClassName("fltrow")&&document.getElementsByClassName("fltrow")[0]&&(i=document.getElementsByClassName("fltrow")[0].getElementsByTagName("td"));for(var n=0;n<i.length;n++)i[n].style="border: 1px solid #D3D3D3",i[n].classList.add(a[n])}function locus_validation(){var e=document.getElementById("locus").value;9==e.length&&("A"==e[0]||"a"==e[0])&&("T"==e[1]||"t"==e[1])&&(e[2]>=1&&e[2]<=5||"C"==e[2]||"M"==e[2]||"c"==e[2]||"m"==e[2])&&("G"==e[3]||"g"==e[3])&&e[4]>=0&&e[4]<=9&&e[5]>=0&&e[5]<=9&&e[6]>=0&&e[6]<=9&&e[7]>=0&&e[7]<=9&&e[8]>=0&&e[8]<=9?$("#locus_button").removeAttr("disabled"):$("#locus_button").prop("disabled",!0)}function yscale_validation(){var e=document.getElementById("yscale_input").value;parseInt(e)>0||"Auto"==e||""==e?$("#locus_button").removeAttr("disabled"):$("#locus_button").prop("disabled",!0)}function rpkm_validation(){parseInt(document.getElementById("rpkm_scale_input").value)>0?$("#abs_scale_button").removeAttr("disabled"):$("#abs_scale_button").prop("disabled",!0)}var base_dataset_dictionary={"Araport 11 RNA-seq data":"cgi-bin/data/bamdata_araport11.xml","Developmental transcriptome - Klepikova et al":"cgi-bin/data/bamdata_Developmental_transcriptome.xml"},databasesAdded=!1;function reset_database_options(){$(".userAdded").remove(),dataset_dictionary=base_dataset_dictionary,list_modified=!1,databasesAdded=!1}var xml_title,get_xml_list_output=[],user_exist=!1,list_modified=!1,check_for_change=0,match_title={},title_list=[];function get_user_XML_display(){var e=findAuthUser();""==users_email&&null==users_email&&null==users_email||users_email!==e?""!=users_email&&users_email!=e&&(signOut(),alert("Error occurred with your account, you have now been logged out. Please log back in")):$.ajax({url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/get_xml_list.php?user="+users_email,dataType:"json",failure:function(e){console.log("ERROR! Something went wrong")},success:function(e){match_title={},title_list=[];var t=1,a=1;if("fail"==(get_xml_list_output=e).status)console.log("Error code: "+get_xml_list_output.error),user_exist=!1;else if("success"==get_xml_list_output.status){user_exist=!0,check_for_change!=get_xml_list_output.files.length&&(reset_database_options(),list_modified=!1),check_for_change=get_xml_list_output.files.length;if(get_xml_list_output.files.length>0)for(i=0;i<get_xml_list_output.files.length;i++){""==(xml_title=get_xml_list_output.files[i][1])||"Uploaded dataset"==xml_title||null==xml_title||null==xml_title?(xml_title="Uploaded dataset - Unnamed dataset #"+t,t+=1):"Araport 11 RNA-seq data"==xml_title?(xml_title="Araport 11 RNA-seq data - Private version #"+a,a+=1):"Developmental transcriptome - Klepikova et al"==xml_title&&(xml_title="Developmental transcriptome - Klepikova et al - Private version #"+a,a+=1),title_list.push(xml_title),xml_fle_name=get_xml_list_output.files[i][0],match_title[xml_title]=xml_fle_name,i==get_xml_list_output.files.length-1&&create_data_list(get_xml_list_output.files.length)}setTimeout((function(){if(0==list_modified)for(i=0;i<get_xml_list_output.files.length;i++)dataset_dictionary[title_list[i]]=datalist_Title[title_list[i]],document.getElementById("xmlDatabase").innerHTML+='<option class="userAdded" tag="private" value="'+title_list[i]+'" id="'+title_list[i]+'">'+title_list[i]+"</option>";list_modified=!0}),1e3)}databasesAdded=!0}})}var datalist=[],datalist_Title={};function create_data_list(e){for(datalist=[],datalist_Title={},i=0;i<e;i++)$.ajax({url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/get_xml.php?file="+match_title[title_list[i]],dataType:"json",success:function(e){xml_file=e,datalist.push(xml_file.data)}}),i===e-1&&setTimeout((function(){dlCallLength=e,DatalistXHRCall(datalist)}),200)}var testDoc,dlCallLength=0,dlCallPosition=0;function DatalistXHRCall(e){if(dlCallPosition!=dlCallLength){const t=new XMLHttpRequest;let a=e[dlCallPosition];t.responseType="document",t.onreadystatechange=()=>{if(t.readyState===XMLHttpRequest.DONE&&200===t.status){let a=t.responseXML;if(a){let t=a.getElementsByTagName("files")[0].attributes.xmltitle.nodeValue;datalist_Title[t]=e[dlCallPosition],dlCallPosition+=1,DatalistXHRCall(e)}}},t.open("GET",a),t.send()}}function validateEmail(e){return/\S+@\S+\.\S+/.test(e)}function findAuthUser(){var e="";if(gapi){var t=gapi.auth2.getAuthInstance().currentUser;if(t)for(var a=Object.keys(t),i=0;i<a.length;i++){var n=t[a[i]];if(n&&Object.keys(n).length>0)for(var l=Object.keys(n),o=0;o<l.length;o++){var s=n[l[o]];if(s&&Object.keys(s).length>0)for(var r=Object.keys(s),d=0;d<r.length;d++){var c=s[r[d]];if("string"==typeof c&&validateEmail(c)){e=c;break}}}}else logError("Unable to reach current user from OAuth")}else logError("Unable to reach data from OAuth");return e}function check_if_Google_login(){var e=findAuthUser();""!=users_email&&users_email===e?!1===databasesAdded&&(document.getElementById("private_dataset_header").style.display="block",get_user_XML_display()):""!=users_email&&users_email!=e?(signOut(),alert("Error occurred with your account, you have now been logged out. Please log back in")):remove_private_database()}function add_user_xml_by_upload(){get_user_XML_display(),setTimeout((function(){var e=findAuthUser();0==user_exist?users_email===e?$.ajax({method:"POST",url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/upload.php",data:{user:users_email,xml:upload_src,title:datasetName}}):""!=users_email&&users_email!=e&&(signOut(),alert("Error occurred with your account, you have now been logged out. Please log back in")):1==user_exist&&(null==dataset_dictionary[datasetName]?users_email===e?$.ajax({method:"POST",url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/upload.php",data:{user:users_email,xml:upload_src,title:datasetName}}):""!=users_email&&users_email!=e&&(signOut(),alert("Error occurred with your account, you have now been logged out. Please log back in")):null!=dataset_dictionary[datasetName]&&(users_email===e?(list_modified=!1,check_for_change=0,$.ajax({url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/delete_xml.php?user="+users_email+"&file="+match_title[datasetName]}),$.ajax({method:"POST",url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/upload.php",data:{user:users_email,xml:upload_src,title:datasetName}})):""!=users_email&&users_email!=e&&(signOut(),alert("Error occurred with your account, you have now been logged out. Please log back in")))),get_user_XML_display()}),1e4)}var uploadingData=!1;function which_upload_option(){uploadingData=!0;var e=findAuthUser();""!=users_email&&users_email===e?document.getElementById("upload_modal").click():""!=users_email&&users_email!=e?(signOut(),alert("Error occurred with your account, you have now been logged out. Please log back in")):""==users_email&&document.getElementById("upload_logX").click()}var public_dataset_dictionary={"Araport 11 RNA-seq data":"cgi-bin/data/bamdata_araport11.xml","Developmental transcriptome - Klepikova et al":"cgi-bin/data/bamdata_Developmental_transcriptome.xml"},public_title_list=[],total_amount_of_datasets=0;function delete_fill(){for(var e in $("#delete_fill").empty(),$("#publicDatabaseDownload").empty(),public_title_list=[],public_dataset_dictionary)public_dataset_dictionary.hasOwnProperty(e)&&public_title_list.push(e);var t=0;for(total_amount_of_datasets=public_title_list.length+title_list.length,i=0;i<public_title_list.length;i++)$("#publicDatabaseDownload").append('<input type="checkbox" tag="publicDataCheckbox" class="publicDataCheckbox" onchange="disableDeletePublic()" id="deleteBox_'+t+'" value="'+public_title_list[i]+'"> '+public_title_list[i]+"</input><br>"),t+=1;for(i=0;i<title_list.length;i++)$("#delete_fill").append('<input type="checkbox" tag="privateDataCheckbox" class="privateDataCheckbox" onchange="disableDeletePublic()" id="deleteBox_'+t+'" value="'+title_list[i]+'"> '+title_list[i]+"</input><br>"),t+=1}var isDeletePublicDisabled=!1;function disableDeletePublic(){for(i=0;i<public_title_list.length;i++){if(1==document.getElementById("deleteBox_"+i).checked&&"publicDataCheckbox"==document.getElementById("deleteBox_"+i).className){0==isDeletePublicDisabled&&(document.getElementById("deleteXML_button").classList.add("disabled"),isDeletePublicDisabled=!0);break}1==isDeletePublicDisabled&&(document.getElementById("deleteXML_button").classList.remove("disabled"),isDeletePublicDisabled=!1)}}function CheckIfSelectedXML(){var e=!1,t=findAuthUser();for(i=0;i<title_list.length;i++){var a="deleteBox_"+(i+2);if(1==document.getElementById(a).checked&&users_email===t)return e=!0,!0}if(!1===e)return!1}function delete_selectedXML(){var e=findAuthUser();for(i=0;i<title_list.length;i++){var t="deleteBox_"+(i+2);null!=document.getElementById(t)&&1==document.getElementById(t).checked&&users_email===e&&$.ajax({url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/delete_xml.php?user="+users_email+"&file="+match_title[document.getElementById(t).value]})}databasesAdded=!1}function confirm_deleteUser(){var e=findAuthUser();""!=users_email&&users_email===e&&$("#logoutModal").is(":visible")&&delete_allXMLs(e)}function delete_allXMLs(e){var t=findAuthUser();if(e===t){for(i=0;i<title_list.length;i++){var a="deleteBox_"+(i+2);users_email===t&&$.ajax({url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/delete_xml.php?user="+users_email+"&file="+match_title[document.getElementById(a).value]})}delete_user(),databasesAdded=!1}}function delete_user(){var e=findAuthUser();""!=users_email&&users_email===e&&$.ajax({url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/delete_user.php?user="+users_email}),signOut()}var warningActive_index_XML="nope",warningActive_index_account="nope";function showWarning_index(e){1===e?0==isDeletePublicDisabled&&("nope"==warningActive_index_XML?(document.getElementById("warning_index_xml").className="warning_index",warningActive_index_XML="yes"):"yes"==warningActive_index_XML&&hideWarning_index(e)):2===e&&("nope"==warningActive_index_account?(document.getElementById("warning_index_account").className="warning_index",warningActive_index_account="yes"):"yes"==warningActive_index_account&&hideWarning_index(e))}function hideWarning_index(e){1===e?(document.getElementById("warning_index_xml").className="warning_nope_index",warningActive_index_XML="nope"):2===e&&(document.getElementById("warning_index_account").className="warning_nope_index",warningActive_index_account="nope")}function manage_DownloadXML(){var e=title_list.length+2;for(i=0;i<e;i++){var t="deleteBox_"+i;1==document.getElementById(t).checked&&($("#downloadXML").attr("href",dataset_dictionary[document.getElementById(t).value]).attr("download",document.getElementById(t).value+".xml"),document.getElementById("downloadXML_button").click())}}var table_base="\t\t<tr>\n\t\t\t<th>Title*</th>\n\t\t\t<th>Description*</th>\n\t\t\t<th>Record Number *</th>\n\t\t\t<th>RNA-Seq Data/BAM file repository link*</th>\n\t\t\t<th>Repository type*</th>\n\t\t\t<th>BAM Filename*</th>\n\t\t\t<th>Publication Link</th>\n\t\t\t<th>SRA/NCBI Link</th>\n\t\t\t<th>Total Reads Mapped*</th>\n\t\t\t<th>Read Map Method</th>\n\t\t\t<th>Species*</th>\n\t\t\t<th>Tissue*</th>\n\t\t\t<th>Tissue subunit*</th>\n\t\t\t<th>Controls</th>\n\t\t\t<th>Replicate Controls</th>\n\t\t</tr>\n";function fill_tableCSV(){for($("#XMLtoCSVtable").empty(),i=0;i<total_amount_of_datasets;i++){var e="deleteBox_"+i;$.ajax({url:dataset_dictionary[document.getElementById(e).value],dataType:"xml",failure:function(e){console.log("Failed at opening XML for conversion into a CSV file. Please contact an admin")},success:function(e){$(e).find("files").each((function(){fileTitle=$(this).attr("xmltitle"),""!=fileTitle&&"Uploaded dataset"!=fileTitle||(fileTitle="Uploaded dataset"),fileTitle=fileTitle.split(" ").join("_")}));var t=$(e).find("file"),a="";a+="<table id='"+fileTitle+"'>\n\t<tbody>\n",a+="\t\t<caption>"+fileTitle+"</caption>\n",a+=table_base,t.each((function(){a+="\t\t<tr>\n";var e=$(this).attr("description");a+="\t\t\t<td>"+e+"</td>\n";var t=$(this).attr("info");a+="\t\t\t<td>"+t+"</td>\n";var n=$(this).attr("record_number");a+="\t\t\t<td>"+n+"</td>\n";var l=$(this).attr("name");a+="\t\t\t<td>"+l+"</td>\n";var o=$(this).attr("bam_type");a+="\t\t\t<td>"+o+"</td>\n";var s=$(this).attr("filename");null!=s&&"undefined"!==s&&".bam"!==s||(s="accepted_hits.bam"),a+="\t\t\t<td>"+s+"</td>\n";var r=$(this).attr("publication_link");a+="\t\t\t<td>"+r+"</td>\n";var d=$(this).attr("url");a+="\t\t\t<td>"+d+"</td>\n";var c=$(this).attr("total_reads_mapped");null!=c&&""!=c||(c="0"),a+="\t\t\t<td>"+c+"</td>\n";var u=$(this).attr("read_map_method");a+="\t\t\t<td>"+u+"</td>\n";var m=$(this).attr("species");null!=m&&""!=m||(m="Arabidopsis thaliana"),a+="\t\t\t<td>"+m+"</td>\n";var g=$(this).attr("svgname");a+="\t\t\t<td>"+g+"</td>\n";var p=$(this).attr("svg_subunit");a+="\t\t\t<td>"+p+"</td>\n";var _="";if(null!=$(this).find("controls")[0].innerHTML)for(i=1;i<$(this).find("controls")[0].childNodes.length;i+=2)null!=$(this).find("controls")[0].childNodes[i].firstChild&&(_+=$(this).find("controls")[0].childNodes[i].firstChild.textContent,i<$(this).find("controls")[0].childNodes.length-2&&(_+=", "));a+="\t\t\t<td>"+_+"</td>\n";var h="";if(null!=$(this).find("groupwith")[0].innerHTML)for(i=1;i<$(this).find("groupwith")[0].childNodes.length;i+=2)null!=$(this).find("groupwith")[0].childNodes[i].firstChild&&(h+=$(this).find("groupwith")[0].childNodes[i].firstChild.textContent,i<$(this).find("groupwith")[0].childNodes.length-2&&(h+=", "));a+="\t\t\t<td>"+h+"</td>\n",a+="\t\t</tr>\n"})),a+="\t</tbody>\n</table>",document.getElementById("XMLtoCSVtable").innerHTML+=a}})}}function download_XMLtableCSV(){for(i=0;i<total_amount_of_datasets;i++){var e="deleteBox_"+i;if(1==document.getElementById(e).checked){var t=document.getElementById(e).value.split(" ").join("_");$("#"+t).tableToCSV()}}}var downloadIndexTable_base="\t\t<tr>\n\t\t\t<th>Title</th>\n\t\t\t<th>Record Number</th>\n\t\t\t<th>Tissue</th>\n\t\t\t<th>Tissue subunit</th>\n\t\t\t<th>Locus</th>\n\t\t\t<th>bp Length</th>\n\t\t\t<th>bp Start site</th>\n\t\t\t<th>bp End site</th>\n\t\t\t<th>Total number of reads</th>\n\t\t\t<th>Reads mapped to locus</th>\n\t\t\t<th>rpb</th>\n\t\t\t<th>RPKM</th>\n\t\t\t<th>Controls</th>\n\t\t</tr>\n";function download_mainTableCSV(){document.getElementById("download_icon").classList.add("progressLoading"),document.getElementById("bodyContainer").classList.add("progressLoading"),populate_efp_modal(1),$("#hiddenDownloadModal_table").empty();var e="<table id='downloadIndexTable'>\n\t<tbody>\n";for(e+="\t\t<caption>"+datasetName.split(" ").join("_")+"</caption>\n",e+=downloadIndexTable_base,i=0;i<eFPSortedSRA.length;i++)e+="\t\t<tr>\n",e+="\t\t\t<td>"+sraDict[eFPSortedSRA[i]].title+"</td>\n",e+="\t\t\t<td>"+eFPSortedSRA[i]+"</td>\n",e+="\t\t\t<td>"+sraDict[eFPSortedSRA[i]].svg.substr(4,sraDict[eFPSortedSRA[i]].svg.length-8)+"</td>\n",e+="\t\t\t<td>"+sraDict[eFPSortedSRA[i]].svg_part+"</td>\n",e+="\t\t\t<td>"+sraDict[eFPSortedSRA[i]].locusValue+"</td>\n",e+="\t\t\t<td>"+String(sraDict[eFPSortedSRA[i]].bp_length)+"</td>\n",e+="\t\t\t<td>"+String(sraDict[eFPSortedSRA[i]].bp_start)+"</td>\n",e+="\t\t\t<td>"+String(sraDict[eFPSortedSRA[i]].bp_end)+"</td>\n",e+="\t\t\t<td>"+sraDict[eFPSortedSRA[i]].numberofreads+"</td>\n",e+="\t\t\t<td>"+String(sraDict[eFPSortedSRA[i]].MappedReads)+"</td>\n",e+="\t\t\t<td>"+sraDict[eFPSortedSRA[i]].rpb+"</td>\n",e+="\t\t\t<td>"+String(sraDict[eFPSortedSRA[i]].RPKM[variantPosition].toFixed(2))+"</td>\n",e+="\t\t\t<td>"+String(sraDict[eFPSortedSRA[i]].controlsString)+"</td>\n",e+="\t\t</tr>\n";e+="\t</tbody>\n</table>",document.getElementById("hiddenDownloadModal_table").innerHTML+=e,$("#hiddenDownloadModal_table").tableToCSV(),document.getElementById("download_icon").classList.remove("progressLoading"),document.getElementById("bodyContainer").classList.remove("progressLoading")}var publicData=!0;function changePublicData(e=!1){publicData=!e&&!uploadingData&&(1==document.getElementById("xmlDatabase").selectedIndex||2==document.getElementById("xmlDatabase").selectedIndex)}var isPrecache=!0;function checkPreload(){if(get_input_values(),verifyLoci(locus)){loadingScreen(!1),progress_percent=0,document.title=`eFP-Seq Browser: Loading 0% - ${locus}`,document.getElementById("progress").title="0%",$("div#progress").width(progress_percent+"%");for(const e in public_dataset_dictionary){if(base_src===public_dataset_dictionary[e]){publicData=!0;break}publicData=!1}1==publicData&&"AT2G24270"==locus&&"simple"==dumpMethod&&!1===callDumpOutputs?(variants_radio_options(1),isPrecache=!0):(update_all_images(0),isPrecache=!1)}else console.error(`The following locus is not valid: ${locus}`)}function verifyLoci(e){if("string"==typeof e){let t=new RegExp("^[A][T][MC0-9][G][0-9]{5}[.][0-9]{1,2}$|^[A][T][MC0-9][G][0-9]{5}$","i");return!!e.trim().match(t)}return!1}var parse_output,GFF_List=[];function getGFF(e){GFF_List=[],$.ajax({url:"https://bar.utoronto.ca/webservices/bar_araport/gene_structure_by_locus.php?locus="+e,dataType:"json",failure:function(e){console.log("Getting GFFs (getGFF) information failed to retrieve locus information from Araport11")},success:function(e){if(0!=(parse_output=e).wasSuccessful){var t=parse_output.features[0].subfeatures;for(i=0;i<t.length;i++)null!=t[i].uniqueID?GFF_List.push(t[i].uniqueID):GFF_List.push("Error retrieving unique ID/GFF")}else"fail"==parse_output.status?console.log("Error: Cannot find GFF ID's with parse output. Please contact admin"):"false"==parse_output.wasSuccessful&&(null!=parse_output.error?console.log("Error: Cannot find GFF ID's due to following error: "+parse_output.error+". Please contact admin"):console.log("Error: Cannot find GFF ID's with parse output. Please contact admin"))}})}function addGFF(){if(eachVariant=document.getElementsByClassName("dd-option"),eachVariant.length>0)for(i=0;i<GFF_List.length;i++)document.getElementsByClassName("dd-option")[i]&&document.getElementsByClassName("dd-option")[i].setAttribute("title",GFF_List[i])}function hiddenGoogleSignin(){var e=document.getElementsByClassName("abcRioButtonLightBlue");for(i=0;i<e.length;i++)e[i]&&e[i].setAttribute("id","loginClick"+i)}function remove_private_database(){document.getElementById("private_dataset_header").style.display="none";var e=document.getElementsByClassName("userAdded");for(i=0;i<e.length;i++)$("#xmlDatabase option:last").remove();check_for_change=0}function correctAGIIDInput(){if(document.getElementById("locus")&&document.getElementById("locus").value&&document.getElementById("locus").value.trim().length>0){var e=document.getElementById("locus").value.trim().split("/");e[0]?document.getElementById("locus").value=e[0].toUpperCase().trim():document.getElementById("locus").value=document.getElementById("locus").value.trim(),locus_validation()}}function returnBackToTop(){mainBody=document.getElementById("main_content"),mainBody.scrollTop=0}function toggleOptionsTable(){"false"===document.getElementById("tableToggle").getAttribute("aria-expanded")?(document.getElementById("tableToggle").setAttribute("aria-expanded",!0),document.getElementById("filterDropdown").classList.add("show")):(document.getElementById("tableToggle").setAttribute("aria-expanded",!1),document.getElementById("filterDropdown").classList.remove("show"))}function toggleTableOptionsView(){document.getElementById("tableFilter-tab").classList.value.includes("active")?(document.getElementById("tableFilter-tab").classList.remove("active"),document.getElementById("eFPFilter-tab").classList.add("active"),document.getElementById("tableFilter").classList.remove("show","active"),document.getElementById("eFPFilter").classList.add("show","active")):(document.getElementById("tableFilter-tab").classList.add("active"),document.getElementById("eFPFilter-tab").classList.remove("active"),document.getElementById("tableFilter").classList.add("show","active"),document.getElementById("eFPFilter").classList.remove("show","active"))}var downloadDivNum=1;function downloadDiv(e){html2canvas(document.getElementById(e)).then((e=>{$("#appendCanvas").empty(),e.id="downloadDivNum_"+downloadDivNum,document.getElementById("appendCanvas").appendChild(e),document.getElementById("downloadDivNum_"+downloadDivNum).style.width="100%",$("#DownloadImageModal").modal("toggle"),downloadDivNum++}))}function displayNavBAR(e=!1){$("#navbar_menu").is(":visible")||e?(document.getElementById("navbar_menu").style.display="none",document.getElementById("main_content").className="col-sm-12",document.getElementById("openMenu").style.display="block",document.getElementById("theTable")&&document.getElementById("theTable").classList.add("RNATable")):!1===$("#navbar_menu").is(":visible")&&(document.getElementById("navbar_menu").style.display="block",document.getElementById("main_content").className="col-sm-9",document.getElementById("openMenu").style.display="none",document.getElementById("theTable")&&document.getElementById("theTable").classList.remove("RNATable"))}function adjustFooterSize(){var e=document.getElementById("navbar_menu");e&&(document.getElementById("nm_footer").style.width=e.offsetWidth+"px",e.scrollHeight==e.clientHeight?0==document.getElementById("nm_footer").classList.contains("navbar_menu_footer_overflow_abs")&&(document.getElementById("nm_footer").classList.remove("navbar_menu_footer_overflow_sticky"),document.getElementById("nm_footer").classList.add("navbar_menu_footer_overflow_abs")):e.scrollHeight>e.clientHeight&&0==document.getElementById("nm_footer").classList.contains("navbar_menu_footer_overflow_sticky")&&(document.getElementById("nm_footer").classList.remove("navbar_menu_footer_overflow_abs"),document.getElementById("nm_footer").classList.add("navbar_menu_footer_overflow_sticky")))}function adjustTableOptionsDropdownSize(){document.getElementById("filterDropdown").style.left=(document.body.offsetWidth-2*document.getElementById("tableToggle").offsetWidth-document.getElementById("filterDropdown").offsetWidth).toString()+"px"}function adjustSubmissionIFrameSize(){var e=.7*window.innerHeight;document.getElementById("submissioniframe").height=e+"px"}var usedToggle=!1;function toggleTableCol(e,t){var a=document.getElementsByClassName(e);if(1==t)for(i=0;i<a.length;i++)a[i]&&a[i].removeAttribute("hidden");else if(0==t)for(i=0;i<a.length;i++)a[i]&&a[i].setAttribute("hidden",!0)}var responsiveRNAWidthAdjusted=!1;function responsiveRNAWidthResize(){var e=document.getElementsByClassName("responsiveRNAWidth");if(window.innerWidth<=575){for(i=0;i<e.length;i++)e[i].style.minWidth=.93*window.innerWidth+"px";responsiveRNAWidthAdjusted=!0}else if(window.innerWidth>575&&1==responsiveRNAWidthAdjusted)for(i=0;i<e.length;i++)e[i].style.minWidth="420px"}function toggleResponsiveTableOptions(e,t,a,i,n,l,o){toggleTableCol("colTitle",e),document.getElementById("toggleTitle").checked=e,toggleTableCol("colRNA",t),document.getElementById("toggleRNA").checked=t,toggleTableCol("colrpb",a),document.getElementById("togglerpb").checked=a,toggleTableCol("coleFP",i),document.getElementById("toggleeFP").checked=i,toggleTableCol("colRPKM",n),document.getElementById("toggleRPKM").checked=n,toggleTableCol("colDetails",l),document.getElementById("toggleDetails").checked=l,toggleTableCol("colCompare",o),document.getElementById("toggleCompare").checked=o,RememberToggleOptions(e,t,a,i,n,l,o)}function determineResponsiveTable(){document.body.offsetWidth<=576?(toggleResponsiveTable(2),displayNavBAR(!0)):toggleResponsiveTable(0)}function toggleResponsiveTable(e=0){"none"!=document.getElementById("tableToggle").style.display&&(1==e||window.innerWidth<=575&&0==usedToggle?toggleResponsiveTableOptions(!1,!0,!1,!1,!1,!1,!1):2==e||window.innerWidth>=1100&&0==usedToggle?toggleResponsiveTableOptions(!0,!0,!0,!0,!0,!0,!1):3==e||window.innerWidth<830&&0==usedToggle?toggleResponsiveTableOptions(!0,!0,!1,!1,!1,!1,!1):4==e||window.innerWidth<900&&0==usedToggle?toggleResponsiveTableOptions(!0,!0,!0,!1,!1,!1,!1):5==e||window.innerWidth<990&&0==usedToggle?toggleResponsiveTableOptions(!0,!0,!0,!1,!0,!1,!1):(6==e||window.innerWidth<1100&&0==usedToggle)&&toggleResponsiveTableOptions(!0,!0,!0,!0,!0,!1,!1))}var ToggledTable=[!0,!0,!0,!0,!0,!0,!1];function RememberToggleOptions(e=!0,t=!0,a=!0,i=!0,n=!0,l=!0,o=!1){ToggledTable=[e,t,a,i,n,l,o]}var colSortList=["colTitle","colrpb","colRPKM","colDetails"];function ResizeArrowRow(){for(i=0;i<colSortList.length;i++){var e=colSortList[i]+"Row";document.getElementById(e).style.width=document.getElementById(e).parentNode.offsetWidth-2+"px",CheckElementWidth(colSortList[i]+"Arrow",8)}}function CheckElementWidth(e,t){document.getElementById(e).offsetWidth<t&&(document.getElementById(e).style.width=t+"px")}function ChangeColArrow(e){setTimeout((function(){var t=e+"Arrow";for(document.getElementById(e).classList.contains("headerSortDown")?document.getElementById(t).src="./cgi-bin/SVGs/arrowSortDown.min.svg":document.getElementById(e).classList.contains("headerSortUp")&&(document.getElementById(t).src="./cgi-bin/SVGs/arrowSortUp.min.svg"),i=0;i<colSortList.length;i++){CheckElementWidth(colSortList[i]+"Arrow",8)}}),100)}function ScrollToRNARow(e){document.getElementById("closemodal_efPOverview").click(),$("#main_content").animate({scrollTop:$("#"+e).offset().top},"slow"),document.getElementById(e)&&(document.getElementById(e).className+=" scrollToRow",setTimeout((function(){document.getElementById(e).className+=" scrollToRowRemove"}),2e3),setTimeout((function(){document.getElementById(e).classList.remove("scrollToRow"),document.getElementById(e).classList.remove("scrollToRowRemove")}),4050))}function IfPressEnter(e,t){13!=e.which&&13!=e.keyCode||$("#"+t).click()}var shareLink,BrowserDetected=!1;function DetectBrowser(){if(!1===BrowserDetected){var e,t,a={"Microsoft+Edge":{Contain:["Edge"]},Opera:{Contain:["OPR","Opera"]},Firefox:{Contain:["Firefox"],NContain:["Seamonkey"]},Seamonkey:{Contain:["Seamonkey"]},Chrome:{Contain:["Chrome"],NContain:["Chromium"]},Chromium:{Contain:["Chromium"]},"Internet+Explorer":{Contain:["MSIE"]},Safari:{Contain:["Safari"],NContain:["Chromium","Chrome"]}};a?e=Object.keys(a):logError("Unable retrieve userAgentParser");var l=!0;for(i=0;i<e.length;i++)for(c=0;c<a[e[i]].Contain.length;c++)if(l&&-1!==navigator.userAgent.indexOf(a[e[i]].Contain[c])){if(!a[e[i]].NContain){t=e[i],l=!1;break}var o=a[e[i]].NContain.length,s=0;for(n=0;n<a[e[i]].NContain.length;n++)-1!==navigator.userAgent.indexOf(a[e[i]].NContain[n])&&s++;if(s!=o){t=e[i],l=!1;break}}t&&($("#notChrome").empty(),append_str=' or through the following <a href="https://www.google.com/search?q=manage+cookies+in+'+t+'" target="_blank" rel="noopener">Google search results</a>',$("#notChrome").append(append_str)),BrowserDetected=!0}}function CreateFilteredeFPList(){if($("#filtereFPList").empty(),tissueSRADic){var e=Object.keys(tissueSRADic);for(i=0;i<e.length;i++){var t='<li class="form-check">';t+='<input class="form-check-input" type="checkbox" id="'+e[i].replace(" ","_")+'" onclick="ToggleFilteredeFP(this.id, this.checked);" style="margin: 6px 5px 0;" value="toggleeFP" checked>',t+='<p class="form-check-label" for="toggleTitle" style="padding-left: 20px; font-weight: 10;">'+e[i]+"</p>",t+="</li>",$("#filtereFPList").append(t)}}else logError("Unable to use tissueSRADic")}function ToggleFilteredeFP(e,t){var a=e.replace("_"," "),n=tissueSRADic[a];if(!0===t)for(i=0;i<n.length;i++)document.getElementById(n[i]+"_row")&&document.getElementById(n[i]+"_row").removeAttribute("hidden");else if(!1===t)for(i=0;i<n.length;i++)document.getElementById(n[i]+"_row")&&document.getElementById(n[i]+"_row").setAttribute("hidden",!0)}function LoadSubmittedData(){emptyLanding(),progress_percent=0,document.title=`eFP-Seq Browser: Loading 0% - ${locus}`,loadingScreen(!1),setTimeout((function(){count_bam_num(),disableAllComparison()}),200),update_all_images(0)}function generateShareLink(e=!1){var t="https://"+window.location.host+window.location.pathname;shareLink=t+="?locus="+locus+"&dataset="+base_src,e&&window.history.pushState&&window.history.pushState({},"Title",window.location.pathname+"?locus="+locus+"&dataset="+base_src),document.getElementById("shareLinkTextArea").textContent=shareLink}var shareLinkInputs={};function readShareLink(){var e=window.location.search.substr(1),t=!1,a=!1;if(""!=e){for(var i=e.split("&"),n=0;n<i.length;n++){var l=i[n].split("=");if(l.length>1)if("locus"===l[0].split("%20").join(" ").trim()){var o=i[n].substr(6).split("%20").join(" ").trim();shareLinkInputs.locus=o,document.getElementById("locus").value=o,t=!0}else if("dataset"===l[0].split("%20").join(" ").trim()){o=i[n].substr(8).split("%20").join(" ").trim();shareLinkInputs.dataset=o,base_src=o,a=!0}}t&&a?(emptyLanding(),progress_percent=0,document.title=`eFP-Seq Browser: Loading 0% - ${locus}`,sraDict={},sraCountDic={},loadNewDataset=!1,setTimeout((function(){count_bam_num(),disableAllComparison(),checkPreload()}),200),toggleResponsiveTable(0,!0)):displayError(t&&!1===a?"ERROR IN SHARE LINK! Missing dataset":!1===t&&a?"ERROR IN SHARE LINK! Missing locus":"ERROR IN SHARE LINK! Missing locus and dataset")}}function copyToClipboard(){""!==document.getElementById("shareLinkTextArea").trim()&&(document.getElementById("shareLinkTextArea").select(),document.execCommand("copy"))}var allCheckedOptions=[];function tableCheckbox(e,t=!1){var a=e.split("_")[0];if(t)disableAllComparison();else if(!1===t&&document.getElementById(e)&&document.getElementById(e).checked){allCheckedOptions.push(a);for(var i={},n=0;n<GFF_List.length;n++){var l='<tr class="compareDataRow" id="'+a+"_compareRow"+n+'">';parseInt(n)===parseInt(variantPosition)?l+='<td style="width: 250px; font-size: 12px;" id="'+a+"_compareTitle"+n+'">'+document.getElementById(a+"_title").innerHTML+" ... ("+GFF_List[n]+")</td>\n":l+='<td style="width: 250px; font-size: 12px;" id="'+a+"_compareTitle"+n+'">^^^ ... ('+GFF_List[n]+")</td>\n",l+='<td style="max-width: 576px;"><img loading="lazy" id="'+a+"_rnaseq_img"+n+'" alt="RNA-Seq mapped image for:'+a+'" style="min-width:420px; max-width:576px; width:95%; height: auto;" src="" /><br/><img loading="lazy" id="'+a+"_gene_structure_img"+n+'" style="max-width: 576px; width:100%; height: auto;" src="" alt="Gene variant image for:'+a+'"/></td>\n',l+='<td id="'+a+"_rpb"+n+'" style="font-size: 12px; width: 50px; ">'+sraDict[a].r[n].toFixed(2)+"</td>",l+='<td tag="svg_name" style="width: 75px;"><div id="'+a+"_svg"+n+'" name="'+sraDict[a].svg.substr(4).replace(".","_")+'_tissue" tag='+sraDict[a].svg_part+'_subtissue" width="75" height="75" style="width: 75px; height: 75px; max-width: 75px; max-height: 75px;">'+document.getElementById(sraDict[a].svg.substr(4).replace(".svg","_svg")).innerHTML+'</div><div class="mdl-tooltip" for="'+a+"_svg"+n+'">'+sraDict[a].svg.substring(4).replace(".svg","")+"</div></td>\n",l+='<td id="'+a+"_rpkm"+n+'" style="font-size: 12px; width: 50px; ">'+sraDict[a].RPKM[n].toFixed(2)+"</td>",parseInt(n)===parseInt(variantPosition)?l+='<td style="width: 250px; font-size: 12px;" id="'+a+"_compareTitle"+n+'"><div id="'+a+'_descriptionCompare" name="'+document.getElementById(a+"_description").getAttribute("name")+'">'+document.getElementById(a+"_description").innerHTML+'</div><div id="igbLinkCompare_'+a+'">'+document.getElementById("igbLink_"+a).innerHTML+'</div><div id="extraLinksCompare_'+a+'">'+document.getElementById("extraLinks_"+a).innerHTML+"</div></td>\n":l+='<td style="width: 250px; font-size: 12px;" id="'+a+"_compareTitle"+n+'">^^^</td>\n',l+="</tr>",i[n]=a+"_compareRow"+n,document.getElementById("compareTable").innerHTML+=l,document.getElementById(a+"_rnaseq_img"+n)&&document.getElementById(a+"_rnaseq_img"+n).setAttribute("src",document.getElementById(a+"_rnaseq_img").src),document.getElementById(a+"_gene_structure_img"+n)&&document.getElementById(a+"_gene_structure_img"+n).setAttribute("src",document.getElementsByClassName("dd-option-image")[n].src),sraDict[a].RPKM&&sraDict[a].RPKM[n]&&colour_part_by_id(a+"_svg"+n,sraDict[a].svg_part,sraDict[a].RPKM[n],colouring_mode)}document.getElementById(e).checked=!0,document.getElementById("allCheckbox").checked=!0,"rel"!=colouring_mode&&(document.getElementById("compareGeneVariants").disabled=!1)}else!1===t?(disableCompare(a),allCheckedOptions.splice(allCheckedOptions.indexOf(a),1),document.getElementById(e).checked=!1):!0===t&&disableAllComparison(),0===allCheckedOptions.length&&(document.getElementById("compareGeneVariants").disabled=!0)}function disableCompare(e){for(var t=0;t<GFF_List.length;t++)null!=document.getElementById(e+"_compareRow"+t)&&document.getElementById(e+"_compareRow"+t).remove()}function disableAllComparison(){if(document.getElementById("allCheckbox")){for(var e=(t=document.getElementsByClassName("compareDataRow")).length-1;e>=0;e--)document.getElementsByClassName("compareDataRow")[e].remove();allCheckedOptions=[];var t=document.getElementsByClassName("compareCheckbox");for(e=0;e<t.length;e++)document.getElementsByClassName("compareCheckbox")[e].checked=!1;document.getElementById("allCheckbox").checked=!1;for(var a=[],i=document.getElementsByClassName("mainEntries"),n=0;n<i.length;n++){var l=i[n].id;!1===a.includes(l)?a.push(l):document.getElementsByClassName("mainEntries")[n].remove()}document.getElementById("compareGeneVariants").disabled=!0}}function PnCDisappear(){document.getElementById("PrivacyAndCookies").setAttribute("hidden",!0),document.cookie="eSBAcceptedCookies=1; expires=Friday, December 31, 9999 at 7:00:00 AM;",document.cookie="eSBVersion="+version+"; expires=Friday, December 31, 9999 at 7:00:00 AM;"}function setUpCookies(){for(var e=document.cookie.split(";"),t=void 0,a=void 0,i=0;i<e.length;i++){var n=e[i].split("=");if(n[0]&&"eSBAcceptedCookies"===n[0].trim()&&(t=n[1].trim()),n[0]&&"eSBVersion"===n[0].trim()&&(a=n[1].trim()),t&&a)break}t&&"1"===t?document.getElementById("PrivacyAndCookies").setAttribute("hidden",!1):document.getElementById("PrivacyAndCookies").removeAttribute("hidden"),a&&a!==version&&(document.getElementById("PrivacyAndCookies").removeAttribute("hidden"),document.cookie="eSBAcceptedCookies=0")}function displayVersionNumber(){document.getElementById("feedbackText").innerHTML+="<br><br>The eFP-Seq Browser's current version number is: "+version}function init(){document.getElementById("locus").value="AT2G24270",document.getElementById("xmlDatabase").value="Araport 11 RNA-seq data",locus_validation(),old_locus=locus,yscale_validation(),rpkm_validation(),adjustFooterSize(),displayVersionNumber(),adjustTableOptionsDropdownSize(),setUpCookies(),$("input[type=radio][name=radio_group]").change((function(){gene_structure_radio_on_change()})),$("#locus").keyup((function(){locus_validation()})),$("#yscale_input").keyup((function(){yscale_validation()})),$("#rpkm_scale_input").keyup((function(){rpkm_validation()})),(signInButton=document.getElementsByClassName("abcRioButtonLightBlue").length>0)&&hiddenGoogleSignin(),getGFF(locus),$("#locus").autocomplete({source:function(e,t){var a=e.term.split(/,\s*/).pop();$.ajax({type:"GET",url:"https://bar.utoronto.ca/webservices/eFP-Seq_Browser/idautocomplete.cgi?species=Arabidopsis_thaliana&term="+a,dataType:"json"}).done((function(e){e&&e.length>=7?t(e.slice(0,7)):t(e)}))},close:function(e,t){correctAGIIDInput()}});var e=document.getElementById("submissioniframe");e&&e.setAttribute("src",e.getAttribute("data-src")),adjustSubmissionIFrameSize(),readShareLink()}$(window).resize((function(){adjustFooterSize(),adjustSubmissionIFrameSize(),responsiveRNAWidthResize(),toggleResponsiveTable(),adjustTableOptionsDropdownSize(),setTimeout((function(){adjustFooterSize()}),10)})),adjustFooterSize(),window.addEventListener("load",(function(){init()}));
