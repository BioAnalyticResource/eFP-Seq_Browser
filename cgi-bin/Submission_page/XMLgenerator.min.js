let count_clicks=1,base64="";$((function(){$("#GenerateButton").click((function(){const e=document.getElementById("reqxml").value.replace(/ /g,"_");document.getElementById("not_filled").innerHTML="";let t="";const n=updatebase();correct_links(".sub_link"),correct_ReadMapCount(".readNumberClass"),remove_outline(".reqfield"),remove_outline(".bam_link"),remove_outline_tissue(".reqtissue"),no_null_contact(),check_filename("channelfilename"),check_inputs("inputXMLForm"),document.getElementById("reqxml").value.length>0&&document.getElementById("reqauthor").value.length>0&&check_req(".reqfield")&&check_req_tissue()&&check_links(".channelbamType",".bam_link")?($(".Entries").each((function(e,n){t+=update(t,n)})),$("#ResultXml").val(n+t+existingXML+end),$("#DownloadLink").attr("href",`data:text/xml;base64,${Buffer.from(n+t+existingXML+end).toString("base64")}`).attr("download",e+".xml"),base64=`data:text/xml;base64,${Buffer.from(unescape(encodeURIComponent(n+t+existingXML+end))).toString("base64")}`,$("#generated").show()):(check_req(".reqfield")||outline_req(".reqfield"),check_req_tissue()||outline_req_tissue(),document.getElementById("not_filled").innerHTML+="Please fill in all red highlighted fields. ",check_links(".channelbamType",".bam_link")||(outline_links(".channelbamType",".bam_link"),document.getElementById("not_filled").innerHTML+="<br> Please only use proper and valid links only. BAM Repository Links can only contain Google Drive URLs and/or Amazon AWS URLs. ")),setTimeout((()=>{$("html, body").animate({scrollTop:$(document).height()},"slow")}),50)}))})),$((function(){$("#CloneForm").click(CloneSection)}));const end=["\t</files>"].join("\r\n"),base=['<?xml version="1.0" encoding="UTF-8"?>','\t<files xmltitle="<?channelxmltitle?>" author="<?channelauthor?>" contact="<?channelcontact?>">',"\n"].join("\r\n"),topXML=['\t\t<file info="<?channeldescription?>" record_number="<?channelrecordnumber?>" foreground="<?channelforeground?>" hex_colour="<?channelhexcolor?>" bam_type="<?channelbamType?>" name="<?channelbamlink?>" filename="<?channelfilename?>" total_reads_mapped="<?channeltotalreadsmapped?>" read_map_method="<?channelreadmapmethod?>" publication_link="<?channelpublicationlink?>" svg_subunit="<?channeltissue?>" svgname="<?channelsvgname?>" description="<?channeltitle?>" url="<?channelsralink?>" species="<?channelspecies?>" title="<?channeligbtitle?>">',"\t\t\t<controls>\n"].join("\r\n");let controlsXML=[].join("\r\n"),replicatesXML=["\t\t\t</controls>","\t\t\t<groupwith>\n"].join("\r\n");const endingXML=["\t\t\t</groupwith>","\t\t</file>","\n"].join("\r\n");let existingXML=[].join("\r\n"),all_controls="",all_replicates="";function update(e,t){controlsXML=[].join("\r\n"),all_controls=$(t).find(".channelcontrols").val().split(",");for(let a=0;a<all_controls.length;a++)all_controls[a]=all_controls[a].trim(),controlsXML+=`\t\t\t\t<bam_exp>${all_controls[a]}</bam_exp>\n`;replicatesXML=["\t\t\t</controls>","\t\t\t<groupwith>\n"].join("\r\n"),all_replicates=$(t).find(".channelgroupwidtho").val().split(",");for(let a=0;a<all_replicates.length;a++)all_replicates[a]=all_replicates[a].trim(),replicatesXML+=`\t\t\t\t<bam_exp>${all_replicates[a]}</bam_exp>\n`;const n={channeldescription:$(t).find(".channeldescription").val(),channelrecordnumber:$(t).find(".channelrecordnumber").val(),channelhexcolor:$(t).find(".channelhexcolor").val(),channelbamType:$(t).find(".channelbamType").val(),channelbamlink:$(t).find(".channelbamlink").val(),channeltotalreadsmapped:$(t).find(".channeltotalreadsmapped").val(),channelreadmapmethod:$(t).find(".channelreadmapmethod").val(),channelpublicationlink:$(t).find(".channelpublicationlink").val(),channeltissue:$(t).find(".channeltissue").val(),channelsvgname:$(t).find(".channelsvgname").val(),channeltitle:$(t).find(".channeltitle").val(),channelsralink:$(t).find(".channelsralink").val(),channelspecies:$(t).find(".channelspecies").val(),channelcontrols:$(t).find(".channelcontrols").val(),channelgroupwidtho:$(t).find(".channelgroupwidtho").val(),channelforeground:$(t).find(".channelforeground").val(),channelfilename:$(t).find(".channelfilename").val(),channeligbtitle:document.getElementById("reqxml").value+"/"+$(t).find(".channelrecordnumber").val()};let l=topXML.replace(/<\?(\w+)\?>/g,(function(e,t){return n[t]}));return l+=controlsXML,l+=replicatesXML,l+=endingXML,l}function updatebase(){const e={channelxmltitle:document.getElementById("reqxml").value,channelauthor:document.getElementById("reqauthor").value,channelcontact:document.getElementById("contectinfo").value};return base.replace(/<\?(\w+)\?>/g,(function(t,n){return e[n]}))}let tissue_sub_name="",new_tissue="",new_tissue_subunit="",new_svg="",new_hexID="";function resetLastEntryValues(){$("input[id=reqtitle]").last().val(""),$("textarea[id=reqdesc]").last().val(""),$("input[id=rec]").last().val(""),$("input[id=bam_input]").last().val(""),$("input[id=publink]").last().val(""),$("input[id=sralink]").last().val(""),$("input[id=reqread]").last().val(""),$("input[id=readmapmethod]").last().val(""),$("button[id="+new_tissue+"]").html("Tissue select"),$("input[id="+new_tissue_subunit+"]").last().val(""),$("input[id="+new_hexID+"]").last().val(""),$("input[id=controls]").last().val(""),$("input[id=replicate_controls1]").last().val(""),$("input[id="+new_svg+"]").last().html(""),$("input[id=filename]").last().val("")}function CloneSection(){count_clicks=document.getElementsByClassName("channeltitle").length;const e=document.getElementsByClassName("tissueInput")[document.getElementsByClassName("tissueInput").length-1].value;document.getElementsByClassName("tissueInput")[document.getElementsByClassName("tissueInput").length-1].value="",updateTable(document.getElementsByClassName("tissueInput")[document.getElementsByClassName("tissueInput").length-1].id),$(".SubmissionArea").append($(".Entries:first").clone(!0)),document.getElementsByClassName("tissueInput")[document.getElementsByClassName("tissueInput").length-2].value=e,new_tissue="tissue"+(count_clicks+1),new_tissue_subunit="tissue"+(count_clicks+1)+"_subunit";const t="tissue"+(count_clicks+1)+"_select";new_svg="svg"+(count_clicks+1),new_hexID="hexID_num"+(count_clicks+1);const n="foregroundID_num"+(count_clicks+1),l="tissueInput"+(count_clicks+1);$("legend:last").text("Entry "+(count_clicks+1)),$(".change_div_id").last().attr("name",new_tissue),$(".change_button_id").last().attr("id",new_tissue),$(".change_id_tissue_subunit").last().attr("name",new_tissue_subunit),$(".change_id_tissue_subunit").last().attr("id",new_tissue_subunit),$(".change_id_tissue").last().attr("id",new_tissue),$(".change_tissue_select").last().attr("id",t),$(".change_svg").last().attr("id",new_svg),$(".change_foregroundcolor").last().attr("id",n),$(".change_hexcolor").last().attr("id",new_hexID),$(".tissueInput").last().attr("id",l),$(".tissue_table").last().attr("id","tissueTable_"+l),count_clicks=document.getElementsByClassName("channeltitle").length,resetLastEntryValues()}function DeleteSection(){$("div[id=entries]").length>1&&($("div[id=entries]").last().remove(),count_clicks=document.getElementsByClassName("channeltitle").length)}function resetForm(){for(CloneSection();1!=$("div[id=entries]").length;)$("div[id=entries]").last().remove();resetLastEntryValues(),hideWarning(),$("#araport11XML").empty(),$("#klepikovaXML").empty(),display_add_button(!1),count_clicks=document.getElementsByClassName("channeltitle").length}function correct_links(e){const t=document.getElementById("Entries_all").querySelectorAll(e);const n="?usp=sharing";for(let l=0;l<t.length;l++)t[l].value.length>0&&(t[l].value=t[l].value.trim(),"http://"!=t[l].value.substring(0,7)&&"https://"===t[l].value.substring(0,8)||(t[l].value="https://"+t[l].value),"bam_input"==t[l].id&&t[l].value.substr(t[l].value.length-n.length)==n&&(t[l].value=t[l].value.split(n)[0]))}let tissue_doc,tissue_sub_parse_remove,read_num="";function correct_ReadMapCount(e){const t=document.getElementById("Entries_all").querySelectorAll(e);for(let n=0;n<t.length;n++)t[n].value=t[n].value.trim(),void 0===t[n].value&&(t[n].value=0),t[n].value=only_ReadNum(t[n].value)}function only_ReadNum(e){let t;for(read_num="",t=0;t<e.length;t++)isNaN(e[t])||(read_num+=e[t]);return e=read_num,e=Math.round(e)}function check_links(e,t){const n=document.getElementById("Entries_all").querySelectorAll(t),l=document.getElementById("Entries_all").querySelectorAll(e);for(let a=0;a<n.length;a++)if("bam_input"===n[a].id){if(n[a].value.length>0){if("Google Drive"==l[a].value){const e=n[a].value.split("//");if(e.length>1){const t=e[1];return"drive.google.com"===t.split("/")[0]||"www.drive.google.com"===t.split("/")[0]}return 0===e.length&&("drive.google.com"===e.split("/")[0]||"www.drive.google.com"===e.split("/")[0])}if("Amazon AWS"==l[a].value){const e=new URL(n[a].value);return!(!e.host("s3.amazonaws.com")&&!n[a].value.includes("araport.cyverse-cdn.tacc.cloud")||!check_amazon_for_bam(n[a].value))||((e.host("s3.amazonaws.com")||n[a].value.includes("araport.cyverse-cdn.tacc.cloud/"))&&check_amazon_for_bam(n[a].value),!1)}return!1}return!1}}function check_filename(e){const t=document.getElementsByClassName(e);for(const n of t){const e=n.value.trim().length;if("."==n.value[e-1]&&(n.value=n.value.substring(0,e-1)),n.value.trim().endsWith(".bam"))n.value.trim().endsWith(".bam")&&(n.value=n.value.trim());else{let e=n.value.trim();e+=".bam",n.value=e}}}function check_req(e){let t=0;const n=document.getElementById("Entries_all").querySelectorAll(e).length,l=document.getElementById("Entries_all").querySelectorAll(e);for(let a=0;a<l.length;a++)l[a].value.length>0&&(l[a].value=l[a].value.trim(),t+=1);return t==n}function check_inputs(e){const t=document.getElementsByClassName(e);for(const n of t)if(n.value.length>0&&(n.value=n.value.trim(),n.value.includes('"'))){let e=n.value.replace(/["]/g,"'");n.value=e}}function check_req_tissue(){let e=0;for(let t=1;t<=count_clicks;t++){const n="tissue"+t+"_subunit";document.getElementById(n).value.length>0&&(e+=1)}return e==count_clicks}function outline_req(e){const t=document.getElementById("Entries_all").querySelectorAll(e);for(const n of t)n.value.length<=0&&(n.style.borderColor="#ff2626",n.style.boxShadow="0 0 10px #ff2626")}function outline_req_tissue(){const e=document.getElementById("Entries_all").querySelectorAll(class_name);for(let t=0;t<e.length;t++){const n="tissue"+(t+1)+"_subunit";document.getElementById(n).value.length<=0&&(e[t].style.borderColor="#ff2626",e[t].style.boxShadow="0 0 10px #ff2626")}}function outline_links(e,t){const n=document.getElementById("Entries_all").querySelectorAll(t).length,l=document.getElementById("Entries_all").querySelectorAll(t),a=document.getElementById("Entries_all").querySelectorAll(e);for(let o=0;o<n;o++)if("bam_input"===l[o].id)if(l[o].value.length>0){let e,t;a[o]&&a[o].value&&(e=a[o].value.trim());try{t=new URL(l[o].value)}catch{console.error("Unreadable URL presented: ",l[o].value)}e&&t?"Amazon AWS"===e?check_amazon_for_bam(l[o].value)&&["s3.amazonaws.com","araport.cyverse-cdn.tacc.cloud"].includes(t[host])?(l[o].style.borderColor=null,l[o].style.boxShadow=null):(l[o].style.borderColor="#ff2626",l[o].style.boxShadow="0 0 10px #ff2626"):"Google Drive"===e&&["drive.google.com"].includes(t[host])?(l[o].style.borderColor=null,l[o].style.boxShadow=null):(l[o].style.borderColor="#ff2626",l[o].style.boxShadow="0 0 10px #ff2626"):(l[o].style.borderColor="#ff2626",l[o].style.boxShadow="0 0 10px #ff2626")}else l[o].style.borderColor="#ff2626",l[o].style.boxShadow="0 0 10px #ff2626"}function check_amazon_for_bam(e){return".bam"==e.slice(-4)}function remove_outline(e){document.getElementById("not_filled").innerHTML="";const t=document.getElementById("Entries_all").querySelectorAll(e);for(const n of t)n.value.length>0&&(n.style.borderColor=null,n.style.boxShadow=null)}function remove_outline_tissue(e){document.getElementById("not_filled").innerHTML="";const t=document.getElementById("Entries_all").querySelectorAll(e);for(let n=0;n<t.length;n++)tissue_doc="tissue"+(n+1),tissue_sub_parse_remove="tissue"+(n+1)+"_subunit",document.getElementById(tissue_sub_parse_remove).value.length>0&&(document.getElementById(tissue_doc).style.borderColor=null,document.getElementById(tissue_doc).style.boxShadow=null)}function no_null_contact(){null==document.getElementById("contectinfo")&&(document.getElementById("contectinfo").innerHTML=" ")}let tissue_click="";function designateTissueClick(e){e&&e.includes("tissue")&&(tissue_click=e)}let which_svg="",tissue_subunit="",clicked_id="";function clickclick(e){if(document.getElementById(tissue_click)&&document.getElementById(tissue_click).innerHTML){document.getElementById(tissue_click).innerHTML=e.replace(/_/g," "),tissue_subunit=tissue_click+"_subunit",clicked_id=e,tissue_sub_name=document.getElementById(e).className.split(" ")[1],document.getElementById(tissue_subunit).value=tissue_sub_name;const t=tissue_click.match(/\d/g).join("");which_svg="svg"+t;const n="hexID_num"+t,l="foregroundID_num"+t;document.getElementById(which_svg).value=determine_svgname(e),document.getElementById(n).value=determine_hexcode(determine_svgname(e),e),document.getElementById(l).value=determine_foreground(determine_hexcode(determine_svgname(e),e))}}function determine_svgname(e){return"10_Day_old_Seedling"==e||"10_Day_old_Seedling_roots"==e||"10_Day_old_Seedling_shoots"==e||"ath-10dayOldSeedling.svg"==e?"ath-10dayOldSeedling.svg":"15_Day_old_Seedling"==e||"15_Day_old_Seedling_roots"==e||"15_Day_old_Seedling_shoots"==e||"ath-15dayOldSeedling.svg"==e?"ath-15dayOldSeedling.svg":"Etiolated_seedling"==e||"ath-etiolatedSeedling.svg"==e?"ath-etiolatedSeedling.svg":"Flower"==e||"Flower_receptacle"==e||"ath-Flower.svg"==e?"ath-Flower.svg":"Carpel_petals_stamen_and_sepals"==e||"Flowers_petals"==e||"Flowers_stamen"==e||"Flowers_sepals"==e||"Flowers_carpel"==e||"ath-FlowerParts.svg"==e?"ath-FlowerParts.svg":"Germinating_seed"==e||"ath-GerminatingSeed.svg"==e?"ath-GerminatingSeed.svg":"Internode"==e||"ath-Internode.svg"==e?"ath-Internode.svg":"leaf"==e||"ath-leaf.svg"==e?"ath-leaf.svg":"Full_leaf"==e||"Leaf_lamina"==e||"Leaf_veins"==e||"Leaf_petiole"==e||"ath-LeafParts.svg"==e?"ath-LeafParts.svg":"Pollen"==e||"ath-Pollen.svg"==e?"ath-Pollen.svg":"Roots_tip"==e||"ath-RootTip.svg"==e?"ath-RootTip.svg":"Rosette_shoot"==e||"Rosette_Plus_Root"==e||"Rosette_root"==e||"ath-rosettePlusRoot.svg"==e?"ath-rosettePlusRoot.svg":"Seed_1-4"==e||"ath-Seed1-4.svg"==e?"ath-Seed1-4.svg":"Seed_5-7"==e||"ath-Seed5-7.svg"==e?"ath-Seed5-7.svg":"Seed_8+"==e||"ath-Seed8+.svg"==e?"ath-Seed8+.svg":"Senescent_Leaf"==e||"ath-SenescentLeaf.svg"==e?"ath-SenescentLeaf.svg":"Shoot_Apex_Inflorescense"==e||"ath-ShootApexInflorescense.svg"==e?"ath-ShootApexInflorescense.svg":"Shoot_Apex_Vegetative-Transition"==e||"ath-ShootApexVegetative-Transition.svg"==e?"ath-ShootApexVegetative-Transition.svg":"Silique_1-5"==e||"ath-Silique1-5.svg"==e?"ath-Silique1-5.svg":"Silique_6-10"==e||"ath-Silique6-10.svg"==e?"ath-Silique6-10.svg":"Young_Leaf_1-4_Leaf"==e||"ath-YoungLeaf1-4.svg"==e?"ath-YoungLeaf1-4.svg":"Early_Budding_Flower"==e||"Early_Budding_Flower_shoot"==e||"Early_Budding_Flower_buds"==e||"ath-EarlyBuddingFlower.svg"==e?"ath-EarlyBuddingFlower.svg":"Flower_Bud"==e||"ath-FlowerBud.svg"==e?"ath-FlowerBud.svg":"Stamen"==e||"Stamen_anthers"==e||"Stamen_filament"==e||"ath-Stamen.svg"==e?"ath-Stamen.svg":"Stigma_and_Ovaries"==e||"Stigma"==e||"Ovaries"==e||"ath-StigmaAndOvaries.svg"==e?"ath-StigmaAndOvaries.svg":"Whole_Silique"==e||"Whole_Silique_silique"==e||"Whole_Silique_seed"==e||"ath-WholeSilique.svg"==e?"ath-WholeSilique.svg":"young_Seedling"==e||"young_Seedling_root"==e||"young_Seedling_hypocotyl"==e||"young_Seedling_cotyledon"==e||"ath-youngSeedling.svg"==e?"ath-youngSeedling.svg":"Flower_Development_1"==e||"flowerDevelopmentPart1"==e||"ath-FlowerDevelopment1.svg"==e?"ath-FlowerDevelopment1.svg":"Flower_Development_2"==e||"flowerDevelopmentPart2"==e||"ath-FlowerDevelopment2.svg"==e?"ath-FlowerDevelopment2.svg":"Flower_Development_3"==e||"flowerDevelopmentPart3"==e||"ath-FlowerDevelopment3.svg"==e?"ath-FlowerDevelopment3.svg":"Flower_Development_4"==e||"flowerDevelopmentPart4"==e||"ath-FlowerDevelopment4.svg"==e?"ath-FlowerDevelopment4.svg":"Flower_Development_5"==e||"flowerDevelopmentPart5"==e||"ath-FlowerDevelopment5.svg"==e?"ath-FlowerDevelopment5.svg":"Flower_Development_6-8"==e||"flowerDevelopmentPart6"==e||"ath-FlowerDevelopment6-8.svg"==e?"ath-FlowerDevelopment6-8.svg":"Flower_Development_9-11"==e||"flowerDevelopmentPart9"==e||"ath-FlowerDevelopment9-11.svg"==e?"ath-FlowerDevelopment9-11.svg":"Flower_Development_12-14"==e||"flowerDevelopmentPart12"==e||"ath-FlowerDevelopment12-14.svg"==e?"ath-FlowerDevelopment12-14.svg":"Other"==e||"ath-Other.svg"==e?"ath-Other.svg":void 0}function determine_hexcode(e,t){return"ath-10dayOldSeedling.svg"==e&&"10_Day_old_Seedling_shoots"==t?"0x989800":"ath-10dayOldSeedling.svg"==e&&"10_Day_old_Seedling"==t?"0x98FF00":"ath-10dayOldSeedling.svg"==e&&"10_Day_old_Seedling_roots"==t?"0xCCCC97":"ath-15dayOldSeedling.svg"==e&&"15_Day_old_Seedling_roots"==t||"ath-15dayOldSeedling.svg"==e?"0xbd7740":"ath-etiolatedSeedling.svg"==e?"0xCCCC97":"ath-Flower.svg"==e&&"Flower_receptacle"==t?"0xcaff00":"ath-Flower.svg"==e&&"Flower"==t?"0xCCCC97":"ath-Flower.svg"==e?"0xCCFF00":"ath-FlowerParts.svg"==e&&"Flowers_carpel"==t?"0xe7ff65":"ath-FlowerParts.svg"==e&&"Flowers_petals"==t?"0xcbcb32":"ath-FlowerParts.svg"==e&&"Flowers_sepals"==t?"0xcaff00":"ath-FlowerParts.svg"==e?"0xcbcb32":"ath-GerminatingSeed.svg"==e?"0xf77700":"ath-Internode.svg"==e?"0x99ccff":"ath-leaf.svg"==e?"0x64CC65":"ath-LeafParts.svg"==e&&"Leaf_lamina"==t?"0x65cc66":"ath-LeafParts.svg"==e&&"Leaf_petiole"==t?"0x00cbff":"ath-LeafParts.svg"==e&&"Leaf_veins"==t?"0x007eff":"ath-LeafParts.svg"==e?"0x65cc66":"ath-Pollen.svg"==e?"0xFF0000":"ath-RootTip.svg"==e?"0xBD7740":"ath-rosettePlusRoot.svg"==e?"0x64cc65":"ath-Seed1-4.svg"==e?"0xfe9900":"ath-Seed5-7.svg"==e?"0xfecc00":"ath-Seed8+.svg"==e?"0xf77700":"ath-SenescentLeaf.svg"==e?"0x64cc65":"ath-ShootApexInflorescense.svg"==e?"0x979999":"ath-ShootApexVegetative-Transition.svg"==e?"0x64cc65":"ath-Silique1-5.svg"==e?"0x937326":"ath-Silique6-10.svg"==e?"0x818211":"ath-YoungLeaf1-4.svg"==e?"0x64cc65":"ath-EarlyBuddingFlower.svg"==e?"0xffff66":"ath-FlowerBud.svg"==e?"0xFFFF65":"ath-Stamen.svg"==e&&"Stamen_anthers"==t?"0xff5d5d":"ath-Stamen.svg"==e&&"Stamen_filament"==t?"0xcaff00":"ath-Stamen.svg"==e?"0xff5d5d":"ath-StigmaAndOvaries.svg"==e&&"Ovaries"==t?"0xccff65":"ath-StigmaAndOvaries.svg"==e&&"Stigma"==t?"0xcaff00":"ath-WholeSilique.svg"==e&&"Whole_Silique_silique"==t?"0xb2b42a":"ath-WholeSilique.svg"==e?"0x929326":"ath-youngSeedling.svg"==e&&"young_Seedling_cotyledon"==t?"0x99ff00":"ath-youngSeedling.svg"==e&&"young_Seedling_hypocotyl"==t?"0xcccc98":"ath-youngSeedling.svg"==e&&"young_Seedling_root"==t?"0xc38c60":"ath-youngSeedling.svg"==e?"0x99ff00":"ath-FlowerDevelopment1.svg"==e||"ath-FlowerDevelopment2.svg"==e?"0xe8e846":"ath-FlowerDevelopment3.svg"==e||"ath-FlowerDevelopment4.svg"==e?"0xd3d332":"ath-FlowerDevelopment5.svg"==e||"ath-FlowerDevelopment6.svg"==e||"ath-FlowerDevelopment9.svg"==e||"ath-FlowerDevelopment12.svg"==e?"0xe8e846":"ath-FlowerDevelopment15.svg"==e||"ath-FlowerDevelopment19.svg"==e?"0xffff66":"ath-Other.svg"==e?"0x64cc65":void 0}function determine_foreground(e){if(e&&e.length>2&&e.length<9)return e.substring(2).toUpperCase();console.log("Error retrieving foreground hexcode on the following hexcode: "+e)}function convert_to_json(){document.getElementById("dataInput").value=document.getElementById("dataInput").value.trim(),document.getElementById("closeExcel_modal").click();const e=[],t=document.getElementById("dataInput").value.trim().split("\n"),n=["title","description","record number","rna-seq data/bam file repository link","repository type","bam filename","publication link","sra/ncbi link","total reads mapped","read map method","species","tissue","tissue subunit","controls","replicate controls"];for(let l in t)if(t[l].split("\t")[0]){const a=t[l].split("\t");if(0==l&&"Title*"===a[0].trim())continue;{const t={};for(let e in a)n[e]&&(t[n[e]]=a[e].trim());e.push(t)}}resetForm();for(let l in e){l>0&&CloneSection(),$("select[id=bamType]").last().val(e[l]["repository type"]),$("input[id=reqtitle]").last().val(e[l].title),$("textarea[id=reqdesc]").last().val(e[l].description),$("input[id=rec]").last().val(e[l]["record number"]),$("input[id=bam_input]").last().val(e[l]["rna-seq data/bam file repository link"]),$("input[id=filename]").last().val(e[l]["bam filename"]),$("input[id=publink]").last().val(e[l]["publication link"]),$("input[id=sralink]").last().val(e[l]["sra/ncbi link"]),$("input[id=reqread]").last().val(e[l]["total reads mapped"]),$("input[id=readmapmethod]").last().val(e[l]["read map method"]),$("select[id=reqspecies]").last().val(e[l].species);const t="svg"+(parseInt(l)+1);$("input[id="+t+"]").last().val(determine_svgname(e[l].tissue));const n="tissue"+(parseInt(l)+1);$("button[id="+n+"]").last().html(e[l].tissue.split("_").join(" ")),console.log(n,e[l].tissue);const a="tissue"+(parseInt(l)+1)+"_subunit";$("input[id="+a+"]").last().val(e[l]["tissue subunit"]);const o="hexID_num"+(parseInt(l)+1),s=determine_hexcode(determine_svgname(e[l].tissue),e[l]["tissue subunit*"]);$("input[id="+o+"]").last().val(s.toString());const i="foregroundID_num"+(parseInt(l)+1);$("input[id="+i+"]").last().val(determine_foreground(s)),$("input[id=controls]").last().val(e[l].controls),$("input[id=replicate_controls1]").last().val(e[l]["replicate controls"])}}let warningActive="nope";function showWarning(){"nope"==warningActive?(document.getElementById("warning").className="warning",warningActive="yes"):"yes"==warningActive&&hideWarning()}function hideWarning(){document.getElementById("warning").className="warning_nope",warningActive="nope"}function update_accountAdd_options(){if(""!=parent.users_email&&parent.title_list.length>0){document.getElementById("account_dataDisplay").removeAttribute("style");for(const e of parent.title_list){const t="'"+e+"'";$("#existingDropdown_menu").append('<li style="padding-left: 3px;" onclick="openDataset(event, '+t+'); display_add_button(true); display_or = true;">'+e+"</li>"),$("#privateDatasets").append('<div id="'+e+'" class="tabcontent"><h3>'+e+'</h3><div id="'+e+'_xml"></div></div>')}}else document.getElementById("account_dataDisplay").style.display="none"}function update_existingAdd_options(){display_add_button(display_or),parent.get_user_XML_display(),update_accountAdd_options();const e=new XMLHttpRequest;e.open("GET","cgi-bin/data/bamdata_araport11.xml",!0),e.responseType="document",e.send(),setTimeout((function(){retrieveSRR_existing(e,"araport11XML")}),1e3);const t=new XMLHttpRequest;t.open("GET","cgi-bin/data/bamdata_Developmental_transcriptome.xml",!0),t.responseType="document",t.send(),setTimeout((function(){retrieveSRR_existing(t,"klepikovaXML")}),1e3)}const display_or=!1;function display_add_button(e){e?document.getElementById("addToData").removeAttribute("style"):e||(document.getElementById("addToData").style.display="none")}function retrieveCONTENT_existing(e,t){let n,l;l=e.responseXML,n=l.getElementsByTagName("file");for(const a of n)a.getAttribute("record_number")==t&&(console.log(a),existingXML+="\t\t",existingXML+=a.outerHTML,existingXML+="\n")}function addPublic_toExisting(){existingXML=[].join("\r\n");const e=document.getElementById("araport11XML").childElementCount/2;for(let n=0;n<e;n++){const e="addBox"+n;if(document.getElementById(e).checked){const t=new XMLHttpRequest;t.open("GET","cgi-bin/data/bamdata_araport11.xml",!0),t.responseType="document",t.send(),setTimeout((function(){retrieveCONTENT_existing(t,document.getElementById(e).value)}),1e3)}}const t=document.getElementById("klepikovaXML").childElementCount/2;for(let n=0;n<t;n++){const e="addBox"+n;if(document.getElementById(e).checked){const t=new XMLHttpRequest;t.open("GET","cgi-bin/data/bamdata_Developmental_transcriptome.xml",!0),t.responseType="document",t.send(),setTimeout((function(){retrieveCONTENT_existing(t,document.getElementById(e).value)}),1e3)}}}function openDataset(e,t){let n,l;n=document.getElementsByClassName("tabcontent");for(const a of n)a.style.display="none";l=document.getElementsByClassName("tablinks");for(const a of l)a.className=a.className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"}function changeWidthConverter(){document.getElementById("converter")&&document.getElementById("dataInput")&&(document.getElementById("converter").style.width="100%",document.getElementById("dataInput").style.width="100%")}function updateTable(e){let t,n,l,a;t=document.getElementById(e),n=t.value.toLowerCase(),l=document.getElementById("tissueTable_"+e);const o=l.getElementsByTagName("td");for(const s of o)a=s,a&&(a.innerHTML.toLowerCase().indexOf(n)>-1?s.style.display="":s.style.display="none")}function bamType_placeholder(){"Google Drive"==document.getElementById("bamType").value?$("#bam_input").attr("placeholder",'Please input a Shared View link WITHOUT the "?usp=sharing." at the end'):"Amazon AWS"==document.getElementById("bamType").value&&$("#bam_input").attr("placeholder","Please input the link end with the file like /name.bam")}function toggleTissueSelection(e){document.getElementById(e+"_select").classList.value.includes("show")?document.getElementById(e+"_select").classList.remove("show"):document.getElementById(e+"_select").classList.add("show")}function initGen(){changeWidthConverter()}setTimeout((function(){initGen()}),1e3);